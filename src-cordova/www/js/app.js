(function(e){function t(t){for(var a,n,o=t[0],c=t[1],l=t[2],d=0,p=[];d<o.length;d++)n=o[d],Object.prototype.hasOwnProperty.call(s,n)&&s[n]&&p.push(s[n][0]),s[n]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);u&&u(t);while(p.length)p.shift()();return i.push.apply(i,l||[]),r()}function r(){for(var e,t=0;t<i.length;t++){for(var r=i[t],a=!0,n=1;n<r.length;n++){var c=r[n];0!==s[c]&&(a=!1)}a&&(i.splice(t--,1),e=o(o.s=r[0]))}return e}var a={},s={0:0},i=[];function n(e){return o.p+"js/"+({}[e]||e)+".js"}function o(t){if(a[t])return a[t].exports;var r=a[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.e=function(e){var t=[],r=s[e];if(0!==r)if(r)t.push(r[2]);else{var a=new Promise((function(t,a){r=s[e]=[t,a]}));t.push(r[2]=a);var i,c=document.createElement("script");c.charset="utf-8",c.timeout=120,o.nc&&c.setAttribute("nonce",o.nc),c.src=n(e);var l=new Error;i=function(t){c.onerror=c.onload=null,clearTimeout(d);var r=s[e];if(0!==r){if(r){var a=t&&("load"===t.type?"missing":t.type),i=t&&t.target&&t.target.src;l.message="Loading chunk "+e+" failed.\n("+a+": "+i+")",l.name="ChunkLoadError",l.type=a,l.request=i,r[1](l)}s[e]=void 0}};var d=setTimeout((function(){i({type:"timeout",target:c})}),12e4);c.onerror=c.onload=i,document.head.appendChild(c)}return Promise.all(t)},o.m=e,o.c=a,o.d=function(e,t,r){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)o.d(r,a,function(t){return e[t]}.bind(null,a));return r},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o.oe=function(e){throw console.error(e),e};var c=window["webpackJsonp"]=window["webpackJsonp"]||[],l=c.push.bind(c);c.push=t,c=c.slice();for(var d=0;d<c.length;d++)t(c[d]);var u=l;i.push([0,1]),r()})({0:function(e,t,r){e.exports=r("2f39")},"0096":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("q-banner",{staticClass:"bg-primary text-white",attrs:{rounded:""},scopedSlots:e._u([{key:"avatar",fn:function(){return[r("q-icon",{attrs:{name:"insert_comment",color:"white"}})]},proxy:!0}])},[r("q-icon",{staticClass:"float-right",attrs:{name:"close",color:"white"},on:{click:e.confirmDelete}}),r("div",{staticClass:"row flex"},[r("div",{staticClass:"col-xs-12 col-sm-auto q-mr-md con-name"},[e._v("\n        "+e._s(e.comment.user)+"\n      ")]),r("div",{staticClass:"col-xs-12 col-sm-auto"},[e._v("\n        (le "),r("span",{staticClass:"com-date"},[e._v(e._s(e._f("dateFrench")(e.comment.date)))]),e._v(" à\n        "),r("span",{staticClass:"com-date"},[e._v(e._s(e._f("onlyTime")(e.comment.date)))]),e._v(")\n      ")])]),r("div",{staticClass:"row text-caption com-msg"},[e._v(e._s(e.comment.msg))])],1)],1)},s=[],i=(r("c1df"),{name:"Comment",components:{},data:function(){return{}},props:{comment:{type:Object}},methods:{confirmDelete:function(){var e=this;this.$q.dialog({title:"Confirmation",message:"Voulez-vous vraiment effacer ce commentaire? Cette action est définitive et irréversible!",cancel:!0,persistent:!0}).onOk((function(){e.$emit("deleteComment",e.comment)}))}}}),n=i,o=(r("71ee"),r("2877")),c=r("54e1"),l=r("0016"),d=r("eebe"),u=r.n(d),p=Object(o["a"])(n,a,s,!1,null,null,null);t["default"]=p.exports;u()(p,"components",{QBanner:c["a"],QIcon:l["a"]})},"02ac":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("q-card",{staticClass:"bg-white",attrs:{flat:"",bordered:""}},[r("q-btn",{staticClass:"absolute-top-right text-black q-px-md",attrs:{dense:"",flat:"",color:"primary",icon:"close"},on:{click:e.closeWindow}}),r("div",{staticClass:"row flex-center bg-light-blue-1"},[r("div",[r("h5",[e._v(e._s(e._f("uppercaseFirst")(e.currentOrder.name)))])])]),r("div",{staticClass:"row q-pa-xs"},[r("div",{staticClass:"col-xs-12 col-sm-6 q-pa-sm"},[r("q-list",{attrs:{bordered:"",separator:""}},[r("q-item",[r("q-item-section",[e._v("\n              Date commande :\n            ")]),r("q-item-section",{staticClass:"text-weight-medium",attrs:{avatar:""}},[e._v("\n              "+e._s(e._f("dateFrench")(e.currentOrder.expected_date))+"\n            ")])],1),r("q-item",[r("q-item-section",[e._v("\n              Statut actuel :\n            ")]),r("q-item-section",{staticClass:"text-weight-medium",attrs:{avatar:""}},[r("q-chip",{attrs:{dense:"",color:e.statusColor,"text-color":"white"}},[e._v("\n                "+e._s(e.status)+"\n              ")])],1)],1)],1)],1),r("div",{staticClass:"col-xs-12 col-sm-6 q-pa-sm"},[r("q-list",{attrs:{bordered:"",separator:""}},[r("q-item",[r("q-item-section",[e._v("\n              Numéro de commande :\n            ")]),r("q-item-section",{staticClass:"text-weight-medium",attrs:{avatar:""}},[e._v("\n              "+e._s(e.orderNumber(e.currentOrder.number))+"\n            ")])],1),r("q-item",[r("q-item-section",[e._v("\n              Type de bon :\n            ")]),r("q-item-section",{staticClass:"text-weight-medium",attrs:{avatar:""}},[e._v("\n              "+e._s(e.currentOrder.type)+"\n            ")])],1)],1)],1)]),r("div",{staticClass:"row q-pa-xs"},[r("div",{staticClass:"col-xs-12 col-sm-6 q-pa-sm"},[r("q-list",{attrs:{bordered:"",separator:""}},[r("q-item",[r("q-item-section",[e._v("\n              Contact :\n            ")]),r("q-item-section",{staticClass:"text-weight-medium",attrs:{avatar:""}},[e._v("\n              "+e._s(e.currentOrder.contact_name)+"\n            ")])],1),r("q-item",[r("q-item-section",[e._v("\n              Téléphone :\n            ")]),r("q-item-section",{staticClass:"text-weight-medium",attrs:{avatar:""}},[e._v("\n              "+e._s(e.cleanPhone)+"\n            ")])],1),r("q-item",[r("q-item-section",[e._v("\n              Email :\n            ")]),r("q-item-section",{staticClass:"text-weight-medium",attrs:{avatar:""}},[e._v("\n              "+e._s(e.currentOrder.contact_email)+"\n            ")])],1)],1)],1),r("div",{staticClass:"col-xs-12 col-sm-6 q-pa-sm"},[r("q-list",{attrs:{bordered:"",separator:""}},[r("q-item",[r("q-item-section",[e._v("\n              Adresse :\n            ")]),r("q-item-section",{staticClass:"text-weight-medium",attrs:{avatar:""}},[e._v("\n              "+e._s(e.currentOrder.address_line_1)),r("br"),e._v("\n              "+e._s(e.currentOrder.post_code)+" "+e._s(e.currentOrder.city)+"\n            ")])],1),r("q-item",[r("q-item-section",[e._v("\n              Complément d'adresse :\n            ")]),r("q-item-section",{staticClass:"text-weight-medium",attrs:{avatar:""}},[e._v("\n              "+e._s(e.currentOrder.address_line_2)+"\n            ")])],1)],1)],1)]),r("div",{staticClass:"row q-pa-xs"},[r("div",{staticClass:"col-xs-12 col-sm-6 q-pa-sm"},[r("q-list",{attrs:{bordered:"",separator:""}},[r("q-item",[r("q-item-section",[e._v("\n              Nb d'items commandés :\n            ")]),r("q-item-section",{staticClass:"text-weight-medium",attrs:{avatar:""}},[e._v("\n              "+e._s(e.currentOrder.total_items_ordered)+"\n            ")])],1),r("q-item",[r("q-item-section",[e._v("\n              Nb d'items reçus :\n            ")]),r("q-item-section",{staticClass:"text-weight-medium",attrs:{avatar:""}},[e._v("\n              "+e._s(e.currentOrder.total_items_received)+"\n            ")])],1)],1)],1),r("div",{staticClass:"col-xs-12 col-sm-6 q-pa-sm"},[r("q-list",{attrs:{bordered:"",separator:""}},[r("q-item",[r("q-item-section",[e._v("\n              Nb total de produits commandés :\n            ")]),r("q-item-section",{staticClass:"text-weight-medium",attrs:{avatar:""}},[e._v("\n              "+e._s(e.currentOrder.total_products_ordered)+"\n            ")])],1),r("q-item",[r("q-item-section",[e._v("\n              Nb total de produits reçus :\n            ")]),r("q-item-section",{staticClass:"text-weight-medium",attrs:{avatar:""}},[e._v("\n              "+e._s(e.currentOrder.total_products_received)+"\n            ")])],1)],1)],1)]),r("q-separator"),r("q-btn",{staticClass:"full-width q-my-sm",attrs:{color:"primary",label:"Envoyer sur slack",icon:"chat_bubble_outline",size:"lg"},on:{click:function(t){e.slackPo=!0}}}),r("q-btn",{staticClass:"full-width q-my-sm",attrs:{color:"primary",label:"Commentaire",icon:"notes",size:"lg"},on:{click:function(t){e.comment=!0}}})],1),r("q-dialog",{attrs:{"full-width":""},model:{value:e.slackPo,callback:function(t){e.slackPo=t},expression:"slackPo"}},[r("q-card",{staticClass:"q-pa-xs"},[r("q-card-section",{staticClass:"row items-center"},[r("div",{staticClass:"dialog-box-title"},[e._v("\n          Envoyer un message sur slack concernant cette commande\n        ")])]),r("q-card-section",{staticClass:"row flex-center"},[r("q-input",{staticClass:"full-width",attrs:{filled:"",type:"textarea"},model:{value:e.slackPoMsg,callback:function(t){e.slackPoMsg=t},expression:"slackPoMsg"}})],1),r("q-card-actions",{attrs:{align:"right"}},[r("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Annuler",color:"primary"}}),r("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Valider",color:"primary"},on:{click:e.onSlackPo}})],1)],1)],1),r("q-dialog",{attrs:{"full-width":""},model:{value:e.comment,callback:function(t){e.comment=t},expression:"comment"}},[r("q-card",{staticClass:"q-pa-xs"},[r("q-card-section",{staticClass:"row items-center"},[r("div",{staticClass:"dialog-box-title"},[e._v("\n          Attacher un commentaire à cette commande\n        ")])]),r("q-card-section",{staticClass:"row flex-center"},[r("q-input",{staticClass:"full-width",attrs:{filled:"",type:"textarea"},model:{value:e.commentMsg,callback:function(t){e.commentMsg=t},expression:"commentMsg"}})],1),r("q-card-actions",{attrs:{align:"right"}},[r("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Annuler",color:"primary"}}),r("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Valider",color:"primary"},on:{click:e.onComment}})],1)],1)],1)],1)},s=[],i=(r("b0c0"),r("d3b7"),r("ac1f"),r("25f0"),r("5319"),r("96cf"),r("c973")),n=r.n(i),o=r("c1df"),c=r.n(o),l={name:"SupplierInfos",data:function(){return{currentOrder:null,slackPo:!1,slackPoMsg:"",comment:!1,commentMsg:"",statusColor:"grey"}},props:{order:{type:Object,required:!0}},methods:{orderNumber:function(e){if("CREATED_BY_NYX"==e)return"n/a"},sendToSlack:function(e){var t=this;return n()(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,t.$store.dispatch("sendMessageToSlack",e);case 3:t.$q.notify({message:"Message envoyé !",timeout:5e3,color:"green"}),r.next=9;break;case 6:r.prev=6,r.t0=r["catch"](0),t.$q.notify({message:"Un problème est survenu, veuillez re-essayer plus tard.",timeout:5e3,color:"red"});case 9:case"end":return r.stop()}}),r,null,[[0,6]])})))()},onSlackPo:function(){var e={};e.date=c()(),e.user=this.$store.getters.creds.user.firstname,e.msg=this.slackPoMsg,e.apiUrl=this.$store.getters.apiurl,e.apiKey=this.$store.getters.activeApp.config.restApiKey,e.type="po",e.supplier=this.currentOrder.name,e.poType=this.currentOrder.type,this.sendToSlack(e)},onComment:function(){var e=c()(),t=this.$store.getters.creds.user.firstname+" "+this.$store.getters.creds.user.lastname,r={date:e,user:t,msg:this.commentMsg};this.$emit("addComment",r),this.commentMsg=""},closeWindow:function(){this.$emit("closeSupplier")}},created:function(){console.log(">>>>>>>>>>> ",this.order),this.currentOrder=this.$store.getters.currentOrder.details},mounted:function(){},updated:function(){},computed:{status:function(){return"to_be_collected"===this.currentOrder.status?(this.statusColor="primary","En attente de collecte"):"partially_collected"===this.currentOrder.status?(this.statusColor="warning","En cours de collecte"):"fully_collected"===this.currentOrder.status?(this.statusColor="positive","Terminée"):void 0},cleanPhone:function(){var e=this.currentOrder.contact_phone,t=e.replace(/\s+/g,"");return t.toString().replace(/\d{2}(?=.)/g,"$& ")}}},d=l,u=(r("59ea"),r("2877")),p=r("f09f"),m=r("9c40"),h=r("1c1c"),f=r("66e5"),v=r("4074"),g=r("b047"),b=r("eb85"),_=r("24e8"),y=r("a370"),q=r("27f9"),x=r("4b7e"),w=r("7f67"),O=r("eebe"),C=r.n(O),k=Object(u["a"])(d,a,s,!1,null,null,null);t["default"]=k.exports;C()(k,"components",{QCard:p["a"],QBtn:m["a"],QList:h["a"],QItem:f["a"],QItemSection:v["a"],QChip:g["a"],QSeparator:b["a"],QDialog:_["a"],QCardSection:y["a"],QInput:q["a"],QCardActions:x["a"]}),C()(k,"directives",{ClosePopup:w["a"]})},"05e6":function(e,t,r){},"0b9b":function(e,t,r){"use strict";var a=r("23dd"),s=r.n(a);s.a},"10dc":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("q-card",{staticClass:"bg-white q-pa-xs q-mt-sm q-mb-md",attrs:{flat:"",square:"",bordered:""}},[r("div",{staticClass:"row"},[r("q-select",{ref:"qselect",staticClass:"full-width",attrs:{"use-input":"","input-debounce":"0",label:"AJOUTER UN PRODUIT",options:e.options},on:{filter:e.filterFn,"new-value":e.createValue,input:e.selectedValue,"filter-abort":e.abortFilterFn},scopedSlots:e._u([{key:"no-option",fn:function(){return[r("q-item",[r("q-item-section",{staticClass:"text-grey"},[e._v("\n            Aucun produit référencé chez ce fournisseur\n            "),e.showAddBtn?r("q-btn",{attrs:{color:"primary",label:"Ajouter ce produit"},on:{click:e.addProduct}}):e._e()],1)],1)]},proxy:!0}]),model:{value:e.model,callback:function(t){e.model=t},expression:"model"}})],1)])},s=[],i=(r("4de4"),r("caad"),r("c975"),r("2532"),r("96cf"),r("c973")),n=r.n(i),o=r("bc3a"),c=r.n(o),l={name:"AddItem",props:{supplierName:{type:String,required:!0}},data:function(){return{model:"",otherModel:"",options:[],queryProductsList:{size:500,sort:[{updated_at:{order:"desc",unmapped_type:"boolean"}}],query:{bool:{must:[],filter:[{multi_match:{type:"phrase",query:"",lenient:!0}}]}}},fullProductsList:null,cleanProductsList:null,showAddBtn:!1}},methods:{filterFn:function(e,t,r){var a=this;null===this.cleanProductsList?t((function(){a.getProductsList()})):t((function(){var t=e.toLocaleLowerCase();a.options=a.cleanProductsList.filter((function(e){return e.toLocaleLowerCase().indexOf(t)>-1})),0===a.options.length&&e.length>2?(a.showAddBtn=!0,a.otherModel=e):a.showAddBtn=!1}))},abortFilterFn:function(){},createValue:function(e,t){e.length>0&&(this.options.includes(e)||this.addThisProduct(e))},addProduct:function(){this.addThisProduct(this.otherModel),this.otherModel="",this.model="",this.$refs.qselect.hidePopup()},selectedValue:function(e){this.addThisProduct(e),this.model=null},getProductsList:function(){var e=this;return n()(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.$q.loading.show(),t.next=3,e.requestProductsList();case 3:e.$q.loading.hide();case 4:case"end":return t.stop()}}),t)})))()},requestProductsList:function(){var e=this,t=this.$store.getters.apiurl+"generic_search/product*?token="+this.$store.getters.creds.token;this.queryProductsList.query.bool.filter[0].multi_match.query=this.supplierName,c.a.post(t,this.queryProductsList).then((function(t){e.fullProductsList=t.data.records,e.prepareProducts()})).catch((function(e){}))},prepareProducts:function(){if(this.cleanProductsList=[],this.options=[],0!=this.fullProductsList.length){for(var e=[],t=0;t<this.fullProductsList.length;t++)e[t]=this.fullProductsList[t]._source.title;if(e.sort((function(e,t){var r=e.toLowerCase(),a=t.toLowerCase();return r<a?-1:r>a?1:0})),this.cleanProductsList=e,this.cleanProductsList.length>0){var r=[];for(t=0;t<this.cleanProductsList.length;t++)r.push(this.cleanProductsList[t])}this.options=r}},addThisProduct:function(e){this.$emit("addProduct",{data:e}),this.otherModel="",this.model=""}},created:function(){},mounted:function(){},updated:function(){},computed:{}},d=l,u=r("2877"),p=r("f09f"),m=r("ddd8"),h=r("66e5"),f=r("4074"),v=r("9c40"),g=r("eebe"),b=r.n(g),_=Object(u["a"])(d,a,s,!1,null,null,null);t["default"]=_.exports;b()(_,"components",{QCard:p["a"],QSelect:m["a"],QItem:h["a"],QItemSection:f["a"],QBtn:v["a"]})},"1bc7":function(e,t,r){},"1bd0":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"bg-grey-8 full-width grey-banner"},[r("div",{staticClass:"whole-container"},[r("div",{staticClass:"text-white date-banner"},[e.dateFromShort===e.dateToShort?r("div",{staticClass:"text-center"},[e._v("\n        Date : "),r("b",[e._v(e._s(e._f("dateFrench")(e.dateFrom)))])]):r("div",{staticClass:"text-center"},[e._v("\n        Période : du "),r("b",[e._v(e._s(e._f("dateFrench")(e.dateFrom)))]),e._v(" au\n        "),r("b",[e._v(e._s(e._f("dateFrench")(e.dateTo)))])])]),r("div",{staticClass:"menu-banner float-right"},[r("MainMenu",{on:{today:e.onToday,newDates:e.onNewDates}})],1)])])},s=[],i=r("2b0e"),n=r("c1df"),o=r.n(n),c=r("aa0a");i["a"].component("MainMenu",c["default"]);var l={name:"TargetDate",data:function(){return{dateFrom:null,dateTo:null,dateFromShort:null,dateToShort:null}},methods:{setNewDates:function(e,t){this.dateFrom=e,this.dateTo=t,this.dateFromShort=o()(this.dateFrom).format("DD-MM-YYYY"),this.dateToShort=o()(this.dateTo).format("DD-MM-YYYY");var r={dateFrom:this.dateFrom,dateTo:this.dateTo,dateFromShort:this.dateFromShort,dateToShort:this.dateToShort};this.$store.commit("mutate_targetDate",{dateObj:r}),this.$emit("dateChanged",r)},onToday:function(){var e=o()().startOf("day"),t=o()().endOf("day");this.setNewDates(e,t)},onNewDates:function(e){this.setNewDates(e.data.fr,e.data.to)}},created:function(){""===this.$store.getters.targetDate.dateFrom&&this.onToday()},mounted:function(){this.dateFrom=this.$store.getters.targetDate.dateFrom,this.dateTo=this.$store.getters.targetDate.dateTo,this.dateFromShort=this.$store.getters.targetDate.dateFromShort,this.dateToShort=this.$store.getters.targetDate.dateToShort},beforeDestroy:function(){this.dateFrom=null,this.dateTo=null,this.dateFromShort=null,this.dateToShort=null},computed:{}},d=l,u=(r("6bda"),r("2877")),p=Object(u["a"])(d,a,s,!1,null,null,null);t["default"]=p.exports},"21fe":function(e,t,r){"use strict";var a=r("fbe3"),s=r.n(a);s.a},"22f3":function(e,t,r){},"22f4":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"my-display"},[e.loaded?r("div",{},[r("div",e._l(e.allComments,(function(t){return r("Comment",{key:t.id,staticClass:"q-mb-xs",attrs:{comment:t},on:{deleteComment:e.onDeleteComment}})})),1)]):e._e(),e.loaded?r("q-list",e._l(e.allItems,(function(t,a){return r("CartItem",{key:t.id,attrs:{item_index:a,item:t,closed:e.isClosed},on:{modifyReceived:e.onReceivedModified,deleteItem:e.onDeleteItem,modifyDlc:e.onDlcModified,deleteDlc:e.onDlcDeleted}})})),1):e._e(),e.showAddItem?r("div",{staticClass:"flex-center tppt"},[r("AddItem",{attrs:{supplierName:e.currentOrder.supplier},on:{addProduct:e.onProductAdded}})],1):e._e(),r("q-page-sticky",{attrs:{expand:"",position:"top"}},[e.loaded?r("div",{staticClass:"full-width q-pa-xs bg-primary",staticStyle:{"max-width":"800px"}},[r("div",{staticClass:"row"},[r("div",{staticClass:"col-3 b-c q-pa-xs"},[r("q-btn",{staticClass:"full-width my-btn",attrs:{unelevated:"",padding:"md lg",color:"white","text-color":"primary",icon:"arrow_back_ios",label:e.labelLeft},on:{click:e.backToList}})],1),r("div",{staticClass:"col-6 b-c q-pa-xs"},[r("q-btn",{staticClass:"full-width my-btn",attrs:{unelevated:"",padding:"md lg",color:"white","text-color":"primary",icon:"face",label:e.labelMenu},on:{click:function(t){e.supplierInfoBox=!0}}})],1),r("div",{staticClass:"col-3 b-c q-pa-xs"},[e.isClosed?r("q-btn",{staticClass:"full-width my-btn",attrs:{unelevated:"",padding:"md lg",color:"white","text-color":"primary","icon-right":"create",label:e.labelRightM},on:{click:e.modifyClosed}}):r("q-btn",{staticClass:"full-width my-btn",attrs:{unelevated:"",padding:"md lg",color:"positive","icon-right":"save",label:e.labelRight},on:{click:e.validateOrder}})],1)])]):e._e()]),r("q-dialog",{attrs:{maximized:""},model:{value:e.supplierInfoBox,callback:function(t){e.supplierInfoBox=t},expression:"supplierInfoBox"}},[r("SupplierInfos",{attrs:{order:e.currentOrder},on:{addComment:e.onAddComment,closeSupplier:e.onCloseWindow}})],1),r("q-dialog",{attrs:{"full-width":"",persistent:""},model:{value:e.orderIncomplete,callback:function(t){e.orderIncomplete=t},expression:"orderIncomplete"}},[r("q-card",{staticClass:"q-pa-xs"},[r("q-card-section",{staticClass:"row items-center"},[r("div",{staticClass:"dialog-box-title"},[e._v("\n          Attention\n        ")])]),r("q-card-section",{staticClass:"row flex-center"},[r("q-banner",{staticClass:"bg-orange text-white",attrs:{"inline-actions":"",rounded:""}},[r("div",{staticClass:"text-weight-medium text-body1"},[e._v("\n            Vous ne pouvez pas encore valider ce bon de commande.\n          ")]),r("div",{staticClass:"text-weight-medium text-body1"},[e._v("\n            Tous les produits doivent avoir une quantité avant de pouvoir\n            valider un bon.\n          ")])])],1),r("q-card-actions",{attrs:{align:"right"}},[r("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"j'ai compris",color:"primary"}})],1)],1)],1)],1)},s=[],i=(r("a630"),r("a434"),r("cca6"),r("3ca3"),r("96cf"),r("c973")),n=r.n(i),o=r("2b0e"),c=r("bc3a"),l=r.n(c),d=r("c1df"),u=r.n(d),p=r("10dc"),m=r("0096"),h=r("84c1"),f=r("02ac");o["a"].component("SupplierInfos",f["default"]),o["a"].component("CartItem",h["default"]),o["a"].component("Comment",m["default"]),o["a"].component("AddItem",p["default"]);var v={name:"PurchaseOrderDisplay",components:{SupplierInfos:f["default"],CartItem:h["default"],AddItem:p["default"],Comment:m["default"]},data:function(){return{originalOrder:null,currentOrder:null,allItems:[],allComments:[],disableValidate:!0,loaded:!1,reportObject:null,isClosed:!1,supplierInfoBox:!1,orderIncomplete:!1}},methods:{getPurchaseOrder:function(){var e=this;return n()(regeneratorRuntime.mark((function t(){var r,a,s,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.$q.loading.show(),t.next=3,e.requestOrder();case 3:for(e.$q.loading.hide(),e.allItems=Array.from(JSON.parse(e.currentOrder.line_items)),r=0,a=0;a<e.allItems.length;a++)void 0===e.allItems[a].direct_product&&(r+=1);for(s=0,i=0;i<e.allItems.length;i++)void 0===e.allItems[i].direct_product&&(s+=e.allItems[i].quantity);e.currentOrder.total_items_ordered=r,e.currentOrder.total_products_ordered=s,e.checkPoMissingFields(),e.checkCartMissingFields(),e.allComments=[],e.currentOrder.hasOwnProperty("comments")&&(e.allComments=Array.from(JSON.parse(e.currentOrder.comments))),e.currentOrder.closed&&(e.isClosed=!0),e.$store.commit("mutate_currentOrder",{order:{meta:{id:e.$store.state.pickingModule.currentOrder.meta.id,index:e.$store.state.pickingModule.currentOrder.meta.index},details:{name:e.currentOrder.clean_name,address_line_1:e.currentOrder.address_line_1,address_line_2:e.currentOrder.address_line_2,post_code:e.currentOrder.post_code,city:e.currentOrder.city,contact_name:e.currentOrder.sales_contact_name,contact_email:e.currentOrder.sales_contact_email,contact_phone:e.currentOrder.sales_phone_number,status:e.currentOrder.status,number:e.currentOrder.number,supplier_id:e.currentOrder.supplier_id,type:e.currentOrder.type,picker:e.currentOrder.picker,expected_date:e.currentOrder.expected_date,total_items_ordered:r,total_products_ordered:s,total_items_received:e.currentOrder.total_items_received,total_products_received:e.currentOrder.total_products_received,comments:e.allComments},cart:{line_items:e.allItems}}}),e.loaded=!0;case 18:case"end":return t.stop()}}),t)})))()},requestOrder:function(){var e=this,t=this.$store.getters.apiurl+"generic/"+this.$store.state.pickingModule.currentOrder.meta.index+"/"+this.$store.state.pickingModule.currentOrder.meta.id+"?token="+this.$store.getters.creds.token;return l.a.get(t).then((function(t){e.originalOrder=Object.assign({},t.data.data._source),e.currentOrder=t.data.data._source})).catch((function(e){}))},sendOrderToServer:function(){this.checkOrderStatus(),this.currentOrder.updated_at=u()().format("YYYY-MM-DDTHH:mm:ss.SSSSSSZ"),this.currentOrder.line_items=JSON.stringify(this.allItems),this.currentOrder.comments=JSON.stringify(this.allComments);var e={_index:this.$store.state.pickingModule.currentOrder.meta.index,_source:this.currentOrder,_id:this.$store.state.pickingModule.currentOrder.meta.id};this.$store.commit({type:"updateRecord",data:e}),this.$q.notify({message:"Bon de commande sauvegardé",timeout:2e3,color:"green"});var t={_index:"pickupapp_log",_source:{id:this.$store.state.pickingModule.currentOrder.meta.id,date:u()(),user:this.$store.getters.creds.user.login,current_order:this.currentOrder,original_order:this.originalOrder,type:"save_po"},_id:this.$store.state.pickingModule.currentOrder.meta.id+"_"+u()().unix()};return this.$store.commit({type:"updateRecord",data:t}),!0},backToList:function(){var e=this;return n()(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r=50,!e.hasPurchaseOrderChanged()){t.next=5;break}return t.next=4,e.sendOrderToServer();case 4:r=1500;case 5:setTimeout((function(){e.$root.$emit("displayListEvent")}),r);case 6:case"end":return t.stop()}}),t)})))()},onReceivedModified:function(e){var t=this;return n()(regeneratorRuntime.mark((function r(){var a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:t.allItems[e.index].received=e.new_received,a=JSON.parse(JSON.stringify(t.allItems)),t.allItems=null,t.allItems=a,t.isOrderComplete();case 5:case"end":return r.stop()}}),r)})))()},validateOrder:function(){var e=this;return n()(regeneratorRuntime.mark((function t(){var r,a,s,i,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.isOrderComplete()){t.next=4;break}e.orderIncomplete=!0,t.next=20;break;case 4:for(e.currentOrder.status="fully_collected",r=0,a=0;a<e.allItems.length;a++)r+=1;for(s=0,i=0;i<e.allItems.length;i++)s+=e.allItems[i].received;return e.currentOrder.total_items_received=r,e.currentOrder.total_products_received=s,t.next=13,e.isThereSomethingToReport();case 13:return n=t.sent,n&&e.prepareForSlack(),e.currentOrder.closed=!0,t.next=18,e.sendOrderToServer();case 18:e.$q.notify({message:"Bon de commande validé",timeout:3e3,color:"green"}),setTimeout((function(){e.$root.$emit("displayListEvent")}),500);case 20:case"end":return t.stop()}}),t)})))()},hasPurchaseOrderChanged:function(){return this.currentOrder.line_items=JSON.stringify(this.allItems),this.currentOrder.comments=JSON.stringify(this.allComments),JSON.stringify(this.currentOrder)!=JSON.stringify(this.originalOrder)},checkPoMissingFields:function(){this.currentOrder.hasOwnProperty("closed")||(this.currentOrder.closed=!1),this.currentOrder.hasOwnProperty("cart_complete")||(this.currentOrder.cart_complete=2),this.currentOrder.hasOwnProperty("has_dlc")||(this.currentOrder.has_dlc=!1),this.currentOrder.hasOwnProperty("dlc_date")||(this.currentOrder.dlc_date=""),this.currentOrder.hasOwnProperty("picking_state")||(this.currentOrder.picking_state=0),this.currentOrder.hasOwnProperty("comments")||(this.currentOrder.comments=JSON.stringify(new Array)),this.currentOrder.hasOwnProperty("total_items_received")||(this.currentOrder.total_items_received=0),this.currentOrder.hasOwnProperty("total_products_received")||(this.currentOrder.total_products_received=0)},checkCartMissingFields:function(){for(var e=0;e<this.allItems.length;e++)this.allItems[e].hasOwnProperty("received")||(this.allItems[e].received=""),this.allItems[e].hasOwnProperty("dlc")&&(this.allItems[e].dlc_date="")},onAddComment:function(e){this.allComments.push(e)},onDeleteComment:function(e){for(var t=0;t<this.allComments.length;t++)this.allComments[t].msg===e.msg&&this.allComments.splice(t,1)},checkOrderStatus:function(){for(var e=null,t=0,r=0;r<this.allItems.length;r++)void 0===this.allItems[r].direct_product&&(t++,""===this.allItems[r].received?e+=0:this.allItems[r].received===this.allItems[r].quantity?e+=1:this.allItems[r].received<this.allItems[r].quantity?e+=2:this.allItems[r].received>this.allItems[r].quantity&&(e+=1));0===e?(this.currentOrder.cart_complete=2,this.currentOrder.status="to_be_collected"):e===t?(this.currentOrder.cart_complete=1,this.currentOrder.status="fully_collected"):(this.currentOrder.cart_complete=0,this.currentOrder.status="partially_collected")},isOrderComplete:function(){for(var e=!0,t=0;t<this.allItems.length;t++)!0===this.allItems[t].direct_product?0===this.allItems[t].received&&(e=!1):""===this.allItems[t].received&&(e=!1);return e},onProductAdded:function(e){for(var t=!1,r=0;r<this.allItems.length;r++)this.allItems[r].full_title===e.data&&(t=!0);if(!t){var a={full_title:e.data,product_id:null,quantity:0,received:0,variant_id:null,direct_product:!0};this.allItems.push(a)}},onDeleteItem:function(e){this.allItems.splice(e.index,1)},isThereSomethingToReport:function(){var e=!1;this.reportObject={less:[],more:[],new:[]};for(var t=0;t<this.allItems.length;t++)this.allItems[t].received<this.allItems[t].quantity&&(this.reportObject.less.push({title:this.allItems[t].full_title,quantity:this.allItems[t].quantity,received:this.allItems[t].received,sku_code:this.allItems[t].sku}),e=!0);for(t=0;t<this.allItems.length;t++)this.allItems[t].received>this.allItems[t].quantity&&!0!==this.allItems[t].direct_product&&(this.reportObject.more.push({title:this.allItems[t].full_title,quantity:this.allItems[t].quantity,received:this.allItems[t].received,sku_code:this.allItems[t].sku}),e=!0);for(t=0;t<this.allItems.length;t++)this.allItems[t].received>this.allItems[t].quantity&&!0===this.allItems[t].direct_product&&(this.reportObject.new.push({title:this.allItems[t].full_title,quantity:this.allItems[t].quantity,received:this.allItems[t].received}),e=!0);return e},prepareForSlack:function(){var e={};e.date=u()(),e.user=this.$store.getters.creds.user.firstname,e.apiUrl=this.$store.getters.apiurl,e.apiKey=this.$store.getters.activeApp.config.restApiKey,e.type="problem",e.supplier=this.currentOrder.supplier,e.problems=this.reportObject,e.poType=this.currentOrder.type,this.sendToSlack(e)},sendToSlack:function(e){var t=this;return n()(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,t.$store.dispatch("sendMessageToSlack",e);case 3:t.$q.notify({message:"Message envoyé !",timeout:5e3,color:"green"}),r.next=9;break;case 6:r.prev=6,r.t0=r["catch"](0),t.$q.notify({message:"Un problème est survenu, veuillez re-essayer plus tard.",timeout:5e3,color:"red"});case 9:case"end":return r.stop()}}),r,null,[[0,6]])})))()},modifyClosed:function(){var e=this;this.$q.dialog({title:"Confirmez svp",message:"Voulez-vous vraiment modifier ce bon déjà validé ?",cancel:!0,persistent:!0}).onOk((function(){e.currentOrder.closed=!1,e.isClosed=!1}))},onDlcModified:function(e){this.allItems[e.index].dlc_date=e.new_dlcDate,this.allItems[e.index].has_dlc=!0,this.currentOrder.has_dlc=!0},onDlcDeleted:function(e){this.allItems[e.index].dlc_date="",this.allItems[e.index].has_dlc=!1,this.currentOrder.has_dlc=!1},onCloseWindow:function(){this.supplierInfoBox=!1}},created:function(){},beforeMount:function(){},mounted:function(){this.getPurchaseOrder()},computed:{labelMenu:function(){return this.$store.getters.screenSize.windowWidth<600?"":void 0===this.currentOrder.clean_name?this.currentOrder.supplier:this.currentOrder.clean_name},labelLeft:function(){return this.$store.getters.screenSize.windowWidth<600?"":"retour"},labelRight:function(){return this.$store.getters.screenSize.windowWidth<600?"":"valider"},labelRightM:function(){return this.$store.getters.screenSize.windowWidth<600?"":"modifier"},showAddItem:function(){return!(!this.loaded||this.currentOrder.closed)}}},g=v,b=(r("6644"),r("2877")),_=r("1c1c"),y=r("de5e"),q=r("9c40"),x=r("24e8"),w=r("f09f"),O=r("a370"),C=r("54e1"),k=r("4b7e"),S=r("7f67"),$=r("eebe"),P=r.n($),j=Object(b["a"])(g,a,s,!1,null,null,null);t["default"]=j.exports;P()(j,"components",{QList:_["a"],QPageSticky:y["a"],QBtn:q["a"],QDialog:x["a"],QCard:w["a"],QCardSection:O["a"],QBanner:C["a"],QCardActions:k["a"]}),P()(j,"directives",{ClosePopup:S["a"]})},"23dd":function(e,t,r){},"25cc":function(e,t,r){},"2f39":function(e,t,r){"use strict";r.r(t);r("ac1f"),r("5319"),r("96cf");var a=r("c973"),s=r.n(a),i=(r("7d6e"),r("e54f"),r("35fc"),r("9f29"),r("573e"),r("62f2"),r("7e6d"),r("2b0e")),n=r("b05d"),o=r("4d5a"),c=r("e359"),l=r("9404"),d=r("09e3"),u=r("9989"),p=r("65c6"),m=r("6ac5"),h=r("9c40"),f=r("0016"),v=r("27f9"),g=r("1c1c"),b=r("66e5"),_=r("8572"),y=r("4074"),q=r("ee89"),x=r("b047"),w=r("ddd8"),O=r("daf4"),C=r("9564"),k=r("52ee"),S=r("ca78"),$=r("714f"),P=r("2a19"),j=r("436b"),D=r("f508"),M=r("b12a");i["a"].use(n["a"],{config:{loading:{delay:400},capacitor:{backButtonExit:!1,backButton:!1},cordova:{backButtonExit:!1,backButton:!0},brand:{primary:"#409EFF",secondary:"#26A69A",accent:"#9C27B0",dark:"#1d1d1d",positive:"#67C23A",negative:"#F56C6C",info:"#909399",warning:"#E6A23C"}},components:{QLayout:o["a"],QHeader:c["a"],QDrawer:l["a"],QPageContainer:d["a"],QPage:u["a"],QToolbar:p["a"],QToolbarTitle:m["a"],QBtn:h["a"],QIcon:f["a"],QInput:v["a"],QList:g["a"],QItem:b["a"],QField:_["a"],QItemSection:y["a"],QUploader:q["a"],QChip:x["a"],QSelect:w["a"],QRating:O["a"],QToggle:C["a"],QDate:k["a"],QTime:S["a"]},directives:{Ripple:$["a"]},plugins:{Notify:P["a"],Dialog:j["a"],Loading:D["a"],AppFullscreen:M["a"]}});var I=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"q-app"}},[r("router-view")],1)},Q=[],L={name:"App"},T=L,A=r("2877"),N=Object(A["a"])(T,I,Q,!1,null,null,null),Y=N.exports,R=r("2f62"),E=r("bc3a"),z=r.n(E),F=r("c1df"),J=r.n(F);r("a709"),r("8d6f"),r("5781");i["a"].use(R["a"]);var B=function(){var e=new R["a"].Store({state:{version:"v1.0.2",apiurl:"https://app.nyx-mvp.ovh/api/v1/",menus:[],apps:[],currentApps:null,activeApp:null,privileges:[],filteredmenus:[],creds:{},maintitle:"",appName:"mobile"},getters:{version:function(e){return e.version},appName:function(e){return e.appName},apiurl:function(e){return e.apiurl},creds:function(e){return e.creds},privileges:function(e){return e.privileges},filteredmenus:function(e){return e.filteredmenus},currentApps:function(e){return e.currentApps},activeApp:function(e){return e.activeApp},menus:function(e){return e.menus},maintitle:function(e){return e.maintitle}},actions:{privileges:function(e){var t=e.commit,r=e.state,a=r.apiurl+"generic_search/nyx_privilege?token="+r.creds.token;z.a.post(a,{size:1e3}).then((function(e){""!=e.data.error?console.log("Privileges error..."):(console.log("Privileges success..."),t("privileges",e.data.records))})).catch((function(e){console.log(e)}))},filters:function(e){var t=e.commit,r=e.state,a=r.apiurl+"generic_search/nyx_filter?token="+r.creds.token;z.a.post(a,{}).then((function(e){""!=e.data.error?console.log("Filters error..."):(console.log("Filters success..."),t("filters",e.data.records))})).catch((function(e){console.log(e)}))}},mutations:{filters:function(e,t){e.filters=t},privileges:function(e,t){e.privileges=t},login:function(e,t){for(var r in console.log("Login mutation called."),e.initialized=!1,e.creds=t.data.cred,e.menus=t.data.menus,e.apps=[],t.data.menus){var a=t.data.menus[r];if("apps"==a.category&&void 0!=a.submenus&&a.submenus.length>0)for(var s in a.submenus)e.apps=a.submenus[s].apps}e.filteredmenus=[];var i=e.menus;for(var n in i)if("apps"!=i[n].category){var o=[];for(var c in i[n].submenus){var l=[];for(var d in i[n].submenus[c].apps){var u=i[n].submenus[c].apps[d].type;"form"!=u&&"free-text"!=u&&"internal"!=u||l.push(i[n].submenus[c].apps[d])}l.length>0&&(i[n].submenus[c].apps=JSON.parse(JSON.stringify(l)),o.push(JSON.parse(JSON.stringify(i[n].submenus[c]))))}o.length>0&&(i[n].submenus=JSON.parse(JSON.stringify(o)),e.filteredmenus.push(i[n]))}e.currentApps=e.filteredmenus[0].submenus[0],e.activeApp=e.filteredmenus[0].submenus[0].apps[0],e.maintitle=e.filteredmenus[0].submenus[0].loc_title,e.maintitleicon=e.filteredmenus[0].submenus[0].icon,console.log("Login mutation done.")},logout:function(e){var t=e.apiurl+"cred/logout?token="+e.creds.token;z.a.get(t).then((function(e){""!=e.data.error?console.log("Logout error..."):console.log("Logout success...")})).catch((function(e){console.log(e)}))},changeApps:function(e,t){console.log("VUEX:CURRENT APP:"),console.log(JSON.stringify(t.data)),e.currentApps=t.data,e.maintitle=t.data.loc_title,e.maintitleicon=t.data.icon,e.timeRangeVisible=t.data.apps[0].timeSelectorChecked},changeApp:function(e,t){console.log("changeApp mutation called.");for(var r=null,a=0;a<e.filteredmenus.length;a++){for(var s=e.filteredmenus[a],n=0;n<s.submenus.length;n++){for(var o=s.submenus[n],c=0;c<o.apps.length;c++)if(o.apps[c].rec_id===t.data){r=o.apps[c],e.currentSubCategory=o;break}if(null!==r)break}if(null!==r)break}e.maintitle=e.currentSubCategory.loc_title,e.activeApp=null,e.activeApp=r,console.log(r),null!=r.timeDefault&&""!=r.timeDefault&&(console.log("send forcetime"),i["a"].prototype.$globalbus.$emit("forcetime",r.timeDefault),console.log("send forcetime"))},updateRecord:function(e,t){var r=e.apiurl+"generic/"+t.data._index+"/"+t.data._id+"?token="+e.creds.token;z.a.post(r,t.data._source).then((function(e){""!=e.data.error?console.log("Save object error..."):console.log("Save object success...")})).catch((function(e){console.log(e)}))},sendMessage:function(e,t){console.log("Send Message");var r=e.apiurl+"sendmessage?token="+e.creds.token,a={destination:""+t.data.destination,body:t.data.message};z.a.post(r,a).then((function(e){""!=e.data.error&&console.log("Unable to send message")})).catch((function(e){console.log(e)}))}}});return e},U=r("8c4f"),V=(r("d3b7"),r("e6cf"),function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("q-layout",{staticClass:"bg-grey-1"},[r("div",{staticClass:"login-container"},[r("q-input",{staticClass:"login-input",attrs:{error:e.$v.form.login.$error,"float-label":"Login",disable:e.loading,clearable:""},on:{blur:e.$v.form.login.$touch,keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submit(t)}},model:{value:e.form.login,callback:function(t){e.$set(e.form,"login",t)},expression:"form.login"}}),r("q-input",{staticClass:"password-input",attrs:{type:"password",error:e.$v.form.password.$error,"float-label":"Password",disable:e.loading,clearable:""},on:{blur:e.$v.form.password.$touch,keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submit(t)}},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}}),r("q-btn",{staticClass:"login-button",attrs:{color:"primary",rounded:"",size:"lg",outline:"",loading:e.loading},on:{click:e.submit}},[e._v("Login")])],1)])}),W=[],H=(r("1276"),r("b5ae")),K={data:function(){return{form:{login:"",password:""},loading:!1}},validations:{form:{login:{required:H["required"]},password:{required:H["required"]}}},methods:{submit:function(){if(this.$v.form.$touch(),this.$v.form.$error)return this.$q.notify({message:"Unable to authenticate.",type:"negative",position:"bottom",closeBtn:!0,timeout:500}),void(this.loading=!1);this.validateUser()},validateUser:function(){var e=this;return s()(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,t.prev=1,console.log(e.$store.getters.apiurl),t.next=5,z.a.post(e.$store.getters.apiurl+"cred/login",{login:e.form.login,password:e.form.password,app:e.$store.getters.appName});case 5:r=t.sent,""==r.data.error?e.authenticate(r):(e.$q.notify({message:r.data.error,type:"negative",position:"bottom",closeBtn:!0,timeout:500}),e.loading=!1),t.next=13;break;case 9:t.prev=9,t.t0=t["catch"](1),e.loading=!1,console.log(t.t0);case 13:e.loading=!1;case 14:case"end":return t.stop()}}),t,null,[[1,9]])})))()},authenticate:function(e){localStorage.authResponse=JSON.stringify(e),this.$i18n.locale=e.data.cred.user.language,e.data.cred.user.user=this.form.login,this.$store.commit({type:"login",data:e.data});var t=this.$store.getters.activeApp.rec_id;this.$store.commit({type:"changeApp",data:t});var r="/main/"+t;console.log("pushing path",r),this.$router.push(r),this.$q.notify({title:this.$t("notifications.message"),message:this.$t("notifications.welcome")+" v("+e.data.version+"/v1.0)",type:"positive",position:"bottom",timeout:500}),this.form.login="",this.form.password="",this.$store.dispatch("privileges"),this.$store.dispatch("filters")}},mounted:function(){var e={};window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,(function(t,r,a){e[r]=a})),void 0!=e["api"]&&(this.$store.state.apiurl=e["api"].split("#")[0])}},X=K,G=(r("da41"),r("57d9"),r("b498")),Z=r("eebe"),ee=r.n(Z),te=Object(A["a"])(X,V,W,!1,null,"83f0a7ea",null),re=te.exports;ee()(te,"components",{QLayout:o["a"],QInput:v["a"],QBtn:h["a"],QColor:G["a"]});var ae=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("q-layout",[r("q-header",[r("q-toolbar",[r("q-btn",{attrs:{flat:"",round:"",dense:"",icon:"menu"},on:{click:function(t){e.showLeft=!e.showLeft}}}),r("q-toolbar-title",[e._v("\n        "+e._s(e.title)+"\n        "),r("span",{attrs:{slot:"subtitle"},slot:"subtitle"},[e._v(e._s(e.maintitle))])])],1)],1),r("q-drawer",{attrs:{side:"left"},model:{value:e.showLeft,callback:function(t){e.showLeft=t},expression:"showLeft"}},[r("div",{staticClass:"bg-brown-1 account-container"},[r("q-icon",{staticClass:"account-icon",attrs:{size:"80px",name:"account_circle",color:"green"}}),e.creds?r("div",{staticClass:"user-info"},[r("small",{staticClass:"text-bold lowercase text-black block"},[e._v(e._s(e.creds.user.firstname)+" "+e._s(e.creds.user.lastname))]),r("small",{staticClass:"text text-grey-7 block"},[e._v(e._s(e.creds.user.user))]),r("small",{staticClass:"logout-button text-bold lowercase text-black block"},[e._v(e._s(e.$store.getters.version))])]):e._e(),r("q-btn",{staticClass:"pwd-button",attrs:{rounded:"",outline:"",color:"negative",size:"sm",label:"Logout"},on:{click:function(t){return e.clickLogout()}}})],1),r("q-list",{attrs:{"no-border":"",link:"","inset-separator":""}},e._l(e.filteredmenus,(function(t,a){return r("span",{key:a},[r("q-item-label",{attrs:{header:""}},[e._v(e._s(t.loc_category))]),e._l(t.submenus,(function(t,a){return r("q-item",{key:a,attrs:{to:"/main/"+t.apps[0].rec_id},nativeOn:{click:function(r){return e.appClicked(t)}}},["form"==t.apps[0].type?r("q-item-section",{attrs:{avatar:"",icon:"insert_drive_file"}}):r("q-item-section",{attrs:{avatar:""}},[r("q-icon",{attrs:{name:"school"}})],1),r("q-item-section",[e._v(e._s(t.loc_title))])],1)}))],2)})),0)],1),r("q-page-container",[r("router-view")],1)],1)},se=[],ie=(r("caad"),r("2532"),r("2ef0"),{name:"home",data:function(){return{title:"NYX Mobile",showLeft:!1}},computed:{apiurl:function(){return this.$store.getters.apiurl},creds:function(){return this.$store.getters.creds},menus:function(){return this.$store.getters.menus},maintitle:function(){if(this.$store.getters.activeApp)return this.$store.getters.activeApp.title},filteredmenus:function(){return this.$store.getters.filteredmenus}},methods:{clickLogout:function(){var e=this;this.$q.dialog({title:"Warning",message:"Are you sure you want to logout ?",color:"negative",ok:!0,cancel:!0}).then((function(){e.logout()})).catch((function(){}))},logout:function(){console.log("BEFCOMMIT"),this.$store.commit({type:"logout",data:{}}),console.log("AFTERCOMMIT"),this.$q.notify({title:this.$t("notifications.message"),message:this.$t("notifications.bye"),type:"positive",position:"bottom",timeout:500}),this.$router.push("/")},appClicked:function(e){"external"==e.type&&window.open(e.config.url)}},created:function(){var e=s()(regeneratorRuntime.mark((function e(){var t,r,a,s,i,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(console.log("Main created"),t={},window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,(function(e,r,a){t[r]=a})),void 0!=t["api"]&&(this.$store.state.apiurl=t["api"].split("#")[0]),void 0!=this.$store.getters.currentSubCategory||!localStorage.authResponse){e.next=20;break}return r=this.$route.path,"/"==r[r.length-1]&&(r=r.substring(0,r.length-1)),a=r.replace("/main/",""),s=JSON.parse(localStorage.authResponse),i=this.$store.getters.apiurl+"status?token="+s.data.cred.token,e.prev=10,e.next=13,z.a.get(i);case 13:n=e.sent,200==n.status&&""==n.data.error&&(this.$store.commit({type:"login",data:s.data}),this.$store.commit({type:"changeApp",data:a}),s.data.cred.user.privileges.includes("admin")&&(this.$store.commit({type:"privileges",data:s.data.all_priv}),this.$store.commit({type:"filters",data:s.data.all_filters}))),e.next=20;break;case 17:e.prev=17,e.t0=e["catch"](10),console.log(e.t0);case 20:case"end":return e.stop()}}),e,this,[[10,17]])})));function t(){return e.apply(this,arguments)}return t}(),mounted:function(){},beforeDestroy:function(){}}),ne=ie,oe=(r("3209"),r("0170")),ce=Object(A["a"])(ne,ae,se,!1,null,"64b1634c",null),le=ce.exports;ee()(ce,"components",{QLayout:o["a"],QHeader:c["a"],QToolbar:p["a"],QBtn:h["a"],QToolbarTitle:m["a"],QDrawer:l["a"],QIcon:f["a"],QList:g["a"],QItemLabel:oe["a"],QItem:b["a"],QItemSection:y["a"],QPageContainer:d["a"]});var de=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",["form"==e.activeApp.type?r("div",[r("Form",{attrs:{config:e.activeApp}})],1):r("div",[r(e.activeApp.config.controller,{tag:"component",attrs:{config:e.activeApp}})],1)])},ue=[],pe=(r("4160"),r("e260"),r("159b"),r("ddb0"),r("ded3")),me=r.n(pe),he=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"form-container"},[e._l(e.formModel,(function(t){return r("q-field",{key:t.field,attrs:{label:e.computeTranslatedText(t.title,e.$store.getters.creds.user.language)}},["string"==t.type?r("q-input",{attrs:{type:t.subtype,color:t.color,inverted:t.inverted,clearable:t.clearable},model:{value:t.value,callback:function(r){e.$set(t,"value",r)},expression:"item.value"}}):e._e(),"number"==t.type?r("q-input",{attrs:{type:t.type,color:t.color,inverted:t.inverted,clearable:t.clearable},model:{value:t.value,callback:function(r){e.$set(t,"value",r)},expression:"item.value"}}):e._e(),"datetime"==t.type?r("q-datetime",{attrs:{color:t.color,inverted:t.inverted,type:t.subtype},model:{value:t.value,callback:function(r){e.$set(t,"value",r)},expression:"item.value"}}):e._e(),"uploader"==t.type?r("q-uploader",{attrs:{color:t.color,inverted:t.inverted,url:t.value}}):e._e(),"chips"==t.type?r("q-chips-input",{attrs:{color:t.color,inverted:t.inverted},model:{value:t.value,callback:function(r){e.$set(t,"value",r)},expression:"item.value"}}):e._e(),"boolean"==t.type?r("q-toggle",{attrs:{color:t.color,inverted:t.inverted},model:{value:t.value,callback:function(r){e.$set(t,"value",r)},expression:"item.value"}}):e._e(),"rating"==t.type?r("q-rating",{attrs:{color:t.color,inverted:t.inverted,max:t.maxRating},model:{value:t.value,callback:function(r){e.$set(t,"value",r)},expression:"item.value"}}):e._e(),"selecter"==t.type?r("q-select",{attrs:{options:t.selectOptions,color:t.color,inverted:t.inverted,multiple:t.multiple},model:{value:t.value,callback:function(r){e.$set(t,"value",r)},expression:"item.value"}}):e._e()],1)})),r("div",{staticClass:"button-box"},[r("q-btn",{staticClass:"send-form-button",attrs:{color:"primary",size:"lg",outline:"",loading:e.loading},on:{click:e.submit}},[e._v("Send")]),r("q-btn",{staticClass:"send-form-button",attrs:{color:"negative",size:"lg",outline:"",disable:e.loading},on:{click:e.reset}},[e._v("Reset")])],1)],2)},fe=[];r("4de4"),r("fb6a"),r("8a79"),r("2ca0");function ve(e,t){if(void 0==e)return"";if(!e.startsWith("@")||!e.endsWith("@"))return e;var r=e.substring(1,e.length-1).split(";"),a={};return r.forEach((function(e){var t=e.split("=");t.length>0&&(a[t[0]]=t[1])})),void 0!=a[t]?a[t]:r}i["a"].filter("formatDate",(function(e){if(e)return J()(String(e)).format("DD/MM")})),i["a"].filter("dateShort",(function(e){if(e)return J()(String(e)).format("DD/MM")})),i["a"].filter("dateClassic",(function(e){if(e)return J()(String(e)).format("DD/MM/YYYY")})),i["a"].filter("dateFrench",(function(e){if(e)return J.a.locale("fr"),J()(String(e)).format("DD MMMM YYYY")})),i["a"].filter("uppercaseFirst",(function(e){if(e)return e.charAt(0).toUpperCase()+e.slice(1)})),i["a"].filter("onlyTime",(function(e){if(e)return J.a.locale("fr"),J()(String(e)).format("HH:mm")}));var ge=r("ebfd"),be=r.n(ge);i["a"].use(be.a);var _e={name:"Form",data:function(){return{formLabelWidth:"120px",chips:["abc"],inverted:!0,loading:!1,formModel:null}},props:{config:{type:Object}},computed:{configin:function(){return this.config}},watch:{configin:function(){this.prepareData()}},created:function(){this.prepareData()},methods:{computeTranslatedText:function(e,t){return ve(e,t)},prepareData:function(){for(var e in console.log("prepare data"),this.formModel=JSON.parse(JSON.stringify(this.config.config.headercolumns)),console.log("prepare data"),console.log(JSON.stringify(this.config.config.headercolumns)),this.formModel){var t=this.formModel[e];if("chips"==t.type)t.value=[];else if("uploader"==t.type)t.value="";else if("string"==t.type)t.value="";else if("boolean"==t.type)t.value=!1;else if("number"==t.type)t.value=0;else if("rating"==t.type)t.value=0;else if("datetime"==t.type)t.subType="datetime",t.value=J.a.now();else if("selecter"==t.type){for(var e in t.selectOptions){var r={label:t.selectOptions[e],value:t.selectOptions[e]};t.selectOptions[e]=r}t.multiple?t.value=[]:t.value=""}else t.value=null;null==t.color&&(t.color="light"),null==t.inverted&&(t.inverted=!0)}var a=JSON.parse(JSON.stringify(this.formModel));this.formModel={},this.formModel=a},reset:function(){this.prepareData()},submit:function(){var e=this;this.loading=!0;var t={_index:this.config.config.index,_source:{},_id:"id_"+Math.floor(16777216*(1+Math.random()))+"_"+Math.floor(16777216*(1+Math.random()))};for(var r in this.formModel){var a=this.formModel[r];t["_source"][a.field]=a.value}t["_source"]["@timestamp"]=J()(),this.$getLocation({enableHighAccuracy:!1}).then((function(r){t._source.location=[r["lng"],r["lat"]],t._source.user=e.$store.getters.creds.user.user;var a="table";void 0!=e.config.config.formmode&&(a=e.config.config.formmode),"table"==a?e.$store.commit({type:"updateRecord",data:t}):e.$store.commit({type:"sendMessage",data:{destination:e.config.config.destination,message:JSON.stringify(t._source)}}),e.$q.notify({title:"saved",message:"Saved",type:"positive",position:"bottom",timeout:500}),e.prepareData(),e.loading=!1})).catch((function(t){alert(t),e.loading=!1}))}}},ye=_e,qe=(r("a82c"),Object(A["a"])(ye,he,fe,!1,null,"49fcdbea",null)),xe=qe.exports;ee()(qe,"components",{QField:_["a"],QInput:v["a"],QDate:k["a"],QUploader:q["a"],QChip:x["a"],QToggle:C["a"],QRating:O["a"],QSelect:w["a"],QBtn:h["a"]});var we=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticStyle:{"text-align":"left"}},[r("h1",[e._v("Free text 3")]),r("span",{domProps:{innerHTML:e._s(e.config.config.freetext)}})])},Oe=[],Ce={name:"FreeText",data:function(){return{}},props:{config:{type:Object}},methods:{},created:function(){},mounted:function(){},beforeDestroy:function(){clearInterval(this.timer)}},ke=Ce,Se=Object(A["a"])(ke,we,Oe,!1,null,null,null),$e=Se.exports;i["a"].component("Form",xe),i["a"].component("FreeText",$e);var Pe=r("92d5"),je={};Pe.keys().forEach((function(e){var t="".concat(e.split(".")[1].split("/")[e.split(".")[1].split("/").length-1]),r=Pe(e).default;console.log(t),je[t]=r}));var De={data:function(){return{selectedTab:"TAB-0",loading:!1}},components:me()({},je),watch:{$route:function(e,t){var r=this;console.log("WATCHER ROUTE GENERIC COMPONENT"),t.params.recid!==e.params.recid?(console.log("from"),console.log(t),console.log("to"),console.log(e),this.loading=!0,this.$store.commit({type:"changeApp",data:this.$route.params.recid}),this.$nextTick((function(){return r.loading=!1}))):console.log("Same recid, no need to change app")}},computed:{activeApp:function(){return this.$store.getters.activeApp},currentApps:function(){return this.$store.getters.currentApps}},methods:{handleTabClick:function(e){}},mounted:function(){},destroyed:function(){},updated:function(){console.log("**********  Updated:")}},Me=De,Ie=Object(A["a"])(Me,de,ue,!1,null,null,null),Qe=Ie.exports,Le=[{path:"/",name:"Login",component:re},{path:"/main",name:"Main",component:le,children:[{path:":recid",name:"GenericComponent",component:Qe}]}];Le.push({path:"*",component:function(){return r.e(2).then(r.bind(null,"e51e"))}});var Te=Le;i["a"].use(U["a"]);var Ae=function(){var e=new U["a"]({scrollBehavior:function(){return{y:0}},routes:Te,mode:"hash",base:""});return e},Ne=function(){return Ye.apply(this,arguments)};function Ye(){return Ye=s()(regeneratorRuntime.mark((function e(){var t,r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("function"!==typeof B){e.next=6;break}return e.next=3,B({Vue:i["a"]});case 3:e.t0=e.sent,e.next=7;break;case 6:e.t0=B;case 7:if(t=e.t0,"function"!==typeof Ae){e.next=14;break}return e.next=11,Ae({Vue:i["a"],store:t});case 11:e.t1=e.sent,e.next=15;break;case 14:e.t1=Ae;case 15:return r=e.t1,t.$router=r,a={router:r,store:t,render:function(e){return e(Y)}},a.el="#q-app",e.abrupt("return",{app:a,store:t,router:r});case 20:case"end":return e.stop()}}),e)}))),Ye.apply(this,arguments)}var Re=r("a925"),Ee={failed:"Action failed",success:"Action was successful",notifications:{message:"message",bye:"bye bye",welcome:"welcome"}},ze={"en-us":Ee},Fe=function(e){var t=e.app,r=e.Vue;r.use(Re["a"]),t.i18n=new Re["a"]({locale:"en-us",fallbackLocale:"en-us",messages:ze})},Je=function(e){var t=e.Vue;t.prototype.$axios=z.a},Be=r("1dce"),Ue=r.n(Be),Ve=function(e){var t=e.Vue;t.use(Ue.a)},We="";function He(){return Ke.apply(this,arguments)}function Ke(){return Ke=s()(regeneratorRuntime.mark((function e(){var t,r,a,s,n,o,c,l,d;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Ne();case 2:t=e.sent,r=t.app,a=t.store,s=t.router,n=!1,o=function(e){n=!0;var t=Object(e)===e?s.resolve(e).route.fullPath:e;window.location.href=t},c=window.location.href.replace(window.location.origin,""),l=[Fe,Je,Ve],d=0;case 11:if(!(!1===n&&d<l.length)){e.next=29;break}if("function"===typeof l[d]){e.next=14;break}return e.abrupt("continue",26);case 14:return e.prev=14,e.next=17,l[d]({app:r,router:s,store:a,Vue:i["a"],ssrContext:null,redirect:o,urlPath:c,publicPath:We});case 17:e.next=26;break;case 19:if(e.prev=19,e.t0=e["catch"](14),!e.t0||!e.t0.url){e.next=24;break}return window.location.href=e.t0.url,e.abrupt("return");case 24:return console.error("[Quasar] boot error:",e.t0),e.abrupt("return");case 26:d++,e.next=11;break;case 29:if(!0!==n){e.next=31;break}return e.abrupt("return");case 31:document.addEventListener("deviceready",(function(){i["a"].prototype.$q.cordova=window.cordova,new i["a"](r)}),!1);case 32:case"end":return e.stop()}}),e,null,[[14,19]])}))),Ke.apply(this,arguments)}He()},3209:function(e,t,r){"use strict";var a=r("25cc"),s=r.n(a);s.a},4580:function(e,t,r){},4678:function(e,t,r){var a={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn-bd":"9686","./bn-bd.js":"9686","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"7333","./en-il.js":"7333","./en-in":"ec2e","./en-in.js":"ec2e","./en-nz":"6f50","./en-nz.js":"6f50","./en-sg":"b7e9","./en-sg.js":"b7e9","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-mx":"b5b7","./es-mx.js":"b5b7","./es-us":"55c9","./es-us.js":"55c9","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df4","./fa.js":"8df4","./fi":"81e9","./fi.js":"81e9","./fil":"d69a","./fil.js":"d69a","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./ga":"5120","./ga.js":"5120","./gd":"f6b4","./gd.js":"f6b4","./gl":"8840","./gl.js":"8840","./gom-deva":"aaf2","./gom-deva.js":"aaf2","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it-ch":"6f12","./it-ch.js":"6f12","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ku":"2421","./ku.js":"2421","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./oc-lnc":"167b","./oc-lnc.js":"167b","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tk":"5aff","./tk.js":"5aff","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf75","./tlh.js":"cf75","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-mo":"3a6c","./zh-mo.js":"3a6c","./zh-tw":"90ea","./zh-tw.js":"90ea"};function s(e){var t=i(e);return r(t)}function i(e){if(!r.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}s.keys=function(){return Object.keys(a)},s.resolve=i,e.exports=s,s.id="4678"},"47e8":function(e,t,r){},5781:function(e,t){},"57d9":function(e,t,r){"use strict";var a=r("c9fc"),s=r.n(a);s.a},"588f":function(e,t,r){"use strict";var a=r("dad6"),s=r.n(a);s.a},"59ea":function(e,t,r){"use strict";var a=r("47e8"),s=r.n(a);s.a},6644:function(e,t,r){"use strict";var a=r("76b2"),s=r.n(a);s.a},6849:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("q-card",{staticClass:"q-pa-xs"},[r("q-card-section",{staticClass:"row items-center"},[r("div",{staticClass:"dialog-box-title"},[e._v("\n      Modifier la quantité\n    ")])]),r("q-card-section",{staticClass:"row flex-center"},[r("q-btn",{directives:[{name:"touch-repeat",rawName:"v-touch-repeat:0:150.mouse.enter.space",value:e.removeQty,expression:"removeQty",arg:"0:150",modifiers:{mouse:!0,enter:!0,space:!0}}],attrs:{round:"",color:"primary",size:"xl",icon:"remove"}}),r("div",{staticClass:"qty-nbr"},[r("h2",[e._v(e._s(e.modifiedQuantity))])]),r("q-btn",{directives:[{name:"touch-repeat",rawName:"v-touch-repeat:0:150.mouse.enter.space",value:e.addQty,expression:"addQty",arg:"0:150",modifiers:{mouse:!0,enter:!0,space:!0}}],attrs:{round:"",color:"primary",size:"xl",icon:"add"}})],1),e.warningBanner?r("q-card-section",{staticClass:"row flex-center"},[r("q-banner",{staticClass:"text-white bg-red",attrs:{"inline-actions":""},scopedSlots:e._u([{key:"avatar",fn:function(){return[r("q-icon",{attrs:{name:"warning",color:"white"}})]},proxy:!0}],null,!1,894313219)},[r("b",[e._v("La quantité reçue est supérieure à la quantité commandée.")])])],1):e._e(),r("q-card-actions",{attrs:{align:"right"}},[r("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Annuler",color:"primary"}}),r("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Valider",color:"primary"},on:{click:e.closeWindow}})],1)],1)},s=[],i=(r("a9e3"),{name:"QuantityAdjust",props:{quantity:{type:Number,required:!0},ordered:{type:Number,required:!0}},data:function(){return{modifiedQuantity:0}},methods:{addQty:function(){this.modifiedQuantity+=1},removeQty:function(){this.modifiedQuantity-=1,this.modifiedQuantity<0&&(this.modifiedQuantity=0)},updateData:function(){this.$emit("quantityModified",{data:this.modifiedQuantity})},closeWindow:function(){this.$emit("quantityModified",{data:this.modifiedQuantity}),this.$emit("closeWindow")}},mounted:function(){this.modifiedQuantity=this.quantity},computed:{warningBanner:function(){if(this.ordered>0)return this.modifiedQuantity>this.ordered}}}),n=i,o=(r("9aaf"),r("2877")),c=r("f09f"),l=r("a370"),d=r("9c40"),u=r("54e1"),p=r("0016"),m=r("4b7e"),h=r("35e7"),f=r("7f67"),v=r("eebe"),g=r.n(v),b=Object(o["a"])(n,a,s,!1,null,null,null);t["default"]=b.exports;g()(b,"components",{QCard:c["a"],QCardSection:l["a"],QBtn:d["a"],QBanner:u["a"],QIcon:p["a"],QCardActions:m["a"]}),g()(b,"directives",{TouchRepeat:h["a"],ClosePopup:f["a"]})},"693a":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("q-item",{staticClass:"q-pa-none"},[r("q-card",{class:e.cardConfig(),attrs:{square:"",flat:"",bordered:""}},[r("div",{directives:[{name:"ripple",rawName:"v-ripple"}],staticClass:"row full-height",attrs:{clickable:""},on:{click:e.onCardClick}},[r("div",{staticClass:"col-xs-2 col-sm-1 text-center date q-pa-sm"},[e._v("\n        "+e._s(e._f("dateShort")(e.expected_date))+"\n      ")]),r("div",{staticClass:"col"},[r("div",{staticClass:"row full-heigth justify-between"},[r("div",{staticClass:"col-xs-12 col-sm-9 name q-pa-sm full-heigth"},[e._v("\n            "+e._s(e._f("uppercaseFirst")(e.supplier))+"\n          ")]),r("div",{staticClass:"col-xs-12 col-sm-3 meta q-pa-sm full-heigth"},[r("OrderTags",{attrs:{closed:e.closed,cart_complete:e.cart_complete,has_dlc:e.has_dlc,picking_state:e.picking_state,comments:e.anyComments,has_direct:e.has_direct_product}})],1)])])])])],1)},s=[],i=(r("a630"),r("a9e3"),r("3ca3"),r("2b0e")),n=r("a4ac");i["a"].component("OrderTags",n["default"]);var o={name:"SupplierCard",props:{expected_date:{type:String,required:!0},supplier:{type:String,required:!0},type:{type:String,required:!0},status:{type:String,required:!0},number:{type:String,required:!0},id:{type:String,required:!0},index:{type:String,required:!0},closed:{type:Boolean,required:!0},cart_complete:{type:Number,required:!0},has_dlc:{type:Boolean,required:!0},picking_state:{type:Number,required:!0},comments:{type:String,required:!0},has_direct_product:{type:Boolean,required:!0}},data:function(){return{anyComments:!1}},methods:{onCardClick:function(){var e={id:this.id,index:this.index};this.$root.$emit("displayOrderEvent",e)},cardConfig:function(){return 0===this.cart_complete?"full-width q-py-sm bg-orange text-white":1===this.cart_complete?"full-width q-py-sm bg-green text-white":2===this.cart_complete?"full-width q-py-sm bg-white text-primary":void 0}},mounted:function(){var e=Array.from(JSON.parse(this.comments));e.length>0&&(this.anyComments=!0)}},c=o,l=(r("588f"),r("2877")),d=r("66e5"),u=r("f09f"),p=r("714f"),m=r("eebe"),h=r.n(m),f=Object(l["a"])(c,a,s,!1,null,null,null);t["default"]=f.exports;h()(f,"components",{QItem:d["a"],QCard:u["a"]}),h()(f,"directives",{Ripple:p["a"]})},"6bda":function(e,t,r){"use strict";var a=r("1bc7"),s=r.n(a);s.a},"71ee":function(e,t,r){"use strict";var a=r("9c71"),s=r.n(a);s.a},"76b2":function(e,t,r){},"7e6d":function(e,t,r){},"84c1":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("q-card",{class:e.bgColor,attrs:{flat:"",square:"",bordered:""}},[r("div",{staticClass:"row q-py-sm"},[r("div",{staticClass:"col-xs-12 col-sm-6 ite-nam q-pa-xs",style:e.textColor},[e._v("\n        "+e._s(e.item.full_title)+"\n      ")]),r("div",{staticClass:"col-xs-12 col-sm-6 ite-ico flex justify-end "},[e.item.direct_product?r("q-btn",{style:e.textColor,attrs:{disable:"",flat:"",square:"",label:"ajout"}}):e._e(),e.item.has_dlc?r("q-btn",{style:e.textColor,attrs:{flat:"",square:"",label:e.dlcLabel,disable:e.closed},on:{click:function(t){e.dlcDate=!0}}}):e._e(),r("div",{staticClass:"row full-height items-center"},[r("q-chip",{staticClass:"quantity-chip",style:e.outlineRed,attrs:{color:e.bgChip,"text-color":"white",size:"16px",clickable:!e.closed},on:{click:function(t){e.quantityProblem=!0}}},[r("div",{staticClass:"text-center full-width"},[e._v("\n              "+e._s(e.chipText)+"\n            ")])])],1),e.item.direct_product?r("q-btn",{style:e.textColor,attrs:{flat:"",square:"",icon:e.checkIcon,disable:e.isDisable},on:{click:e.deleteItem}}):r("q-btn",{style:e.textColor,attrs:{flat:"",square:"",icon:e.checkIcon,disable:e.isDisable},on:{click:e.quantityIsFulfil}})],1)])]),r("q-dialog",{attrs:{"full-width":""},model:{value:e.dlcDate,callback:function(t){e.dlcDate=t},expression:"dlcDate"}},[r("q-card",{staticClass:"q-pa-xs"},[r("q-card-section",{staticClass:"row items-center"},[r("div",{staticClass:"dialog-box-title"},[e._v("\n          Choisir une date limite\n        ")])]),r("q-card-section",{staticClass:"row flex-center"},[r("q-date",{attrs:{locale:e.myLocale},model:{value:e.dlcDateSelection,callback:function(t){e.dlcDateSelection=t},expression:"dlcDateSelection"}})],1),r("q-card-section",{staticClass:"row flex-center"},[r("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Retirer DLC",color:"primary"},on:{click:e.onDlcDelete}})],1),r("q-card-actions",{attrs:{align:"right"}},[r("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Annuler",color:"primary"}}),r("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Valider",color:"primary"},on:{click:e.onDlcDate}})],1)],1)],1),r("q-dialog",{attrs:{"full-width":""},model:{value:e.quantityProblem,callback:function(t){e.quantityProblem=t},expression:"quantityProblem"}},[r("QuantityAdjust",{attrs:{quantity:e.qty,ordered:e.item.quantity},on:{quantityModified:e.onQuantityModified,closeWindow:e.onCloseWindow}})],1)],1)},s=[],i=(r("a9e3"),r("ac1f"),r("1276"),r("2b0e")),n=r("c1df"),o=r.n(n),c=r("6849");i["a"].component("QuantityAdjust",c["default"]);var l={name:"CartItem",data:function(){return{chipText:null,bgColor:"white",textColor:"primary",bgChip:"primary",outlineRed:"border:none;",checkIcon:"check",isDisable:!1,dlcDate:!1,dlcDateSelection:"",myLocale:{days:"Dimanche_Lundi_Mardi_Mercredi_Jeudi_Vendredi_Samedi".split("_"),daysShort:"Dim_Lun_Mar_Mer_Jeu_Ven_Sam".split("_"),months:"Janvier_Février_Mars_Avril_Mai_Juin_Juillet_Août_Septembre_Octobre_Novembre_Décembre".split("_"),monthsShort:"Jan_Fév_Mar_Avr_Mai_Jui_Jui_Aoû_Sep_Oct_Nov_Déc".split("_")},dlcLabel:"DLC",quantityProblem:!1}},props:{item:{type:Object,required:!0},item_index:{type:Number,required:!0},closed:{type:Boolean,required:!0}},methods:{quantityIsFulfil:function(){var e={new_received:this.item.quantity,index:this.item_index};this.$emit("modifyReceived",e)},setChip:function(){""===this.item.received?(this.chipText=this.item.quantity,this.bgColor="bg-white",this.textColor="color: #027be3;",this.bgChip="primary",this.outlineRed="border:none;",this.checkIcon="check",this.isDisable=!1):this.item.received===this.item.quantity?(this.chipText=this.item.received,this.outlineRed="border:none;",!0===this.item.direct_product?(this.bgColor="bg-white",this.textColor="color: #027be3;",this.bgChip="primary",this.checkIcon="backspace",this.closed?this.isDisable=!0:this.isDisable=!1):(this.bgColor="bg-green",this.textColor="color: white;",this.bgChip="green-8",this.checkIcon="check_circle_outline",this.isDisable=!0)):this.item.received<this.item.quantity?(this.chipText=this.item.received+" / "+this.item.quantity,this.bgColor="bg-red",this.textColor="color: white;",this.bgChip="red-9",this.outlineRed="border:none;",this.checkIcon="cancel",this.isDisable=!0):this.item.received>this.item.quantity&&(this.chipText=this.item.received+" / "+this.item.quantity,this.bgColor="bg-green",this.textColor="color: white;",this.bgChip="green-8",this.outlineRed="border:solid #f44336 2px;",!0===this.item.direct_product?(this.checkIcon="backspace",this.closed?this.isDisable=!0:this.isDisable=!1):(this.checkIcon="check_circle_outline",this.isDisable=!0))},setDlcLabel:function(){this.item.has_dlc?this.dlcLabel=o()(this.item.dlc_date).format("DD/MM/YY"):this.dlcLabel="DLC"},deleteItem:function(){var e={index:this.item_index};this.$emit("deleteItem",e)},onDlcDate:function(){var e={new_dlcDate:o()(this.dlcDateSelection,"YYYY/MM/DD"),index:this.item_index};this.$emit("modifyDlc",e)},onDlcDelete:function(){var e={index:this.item_index};this.$emit("deleteDlc",e)},onQuantityModified:function(e){var t={new_received:e.data,index:this.item_index};this.$emit("modifyReceived",t)},onCloseWindow:function(){this.quantityProblem=!1}},created:function(){},mounted:function(){this.setChip(),this.setDlcLabel()},updated:function(){this.setChip(),this.setDlcLabel()},computed:{qty:function(){return""!==this.item.received?this.item.received:this.item.quantity}}},d=l,u=(r("21fe"),r("2877")),p=r("f09f"),m=r("9c40"),h=r("b047"),f=r("24e8"),v=r("a370"),g=r("52ee"),b=r("4b7e"),_=r("7f67"),y=r("eebe"),q=r.n(y),x=Object(u["a"])(d,a,s,!1,null,null,null);t["default"]=x.exports;q()(x,"components",{QCard:p["a"],QBtn:m["a"],QChip:h["a"],QDialog:f["a"],QCardSection:v["a"],QDate:g["a"],QCardActions:b["a"]}),q()(x,"directives",{ClosePopup:_["a"]})},"8d6f":function(e,t){},"92d5":function(e,t,r){var a={"./MvpPicking.vue":"b8d7","./MvpPicking/AddItem.vue":"10dc","./MvpPicking/CartItem.vue":"84c1","./MvpPicking/Comment.vue":"0096","./MvpPicking/MainMenu.vue":"aa0a","./MvpPicking/OrderTags.vue":"a4ac","./MvpPicking/PurchaseOrderDisplay.vue":"22f4","./MvpPicking/PurchaseOrdersList.vue":"b203","./MvpPicking/QuantityAdjust.vue":"6849","./MvpPicking/SupplierCard.vue":"693a","./MvpPicking/SupplierInfos.vue":"02ac","./MvpPicking/TargetDate.vue":"1bd0"};function s(e){var t=i(e);return r(t)}function i(e){if(!r.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}s.keys=function(){return Object.keys(a)},s.resolve=i,e.exports=s,s.id="92d5"},"9aaf":function(e,t,r){"use strict";var a=r("05e6"),s=r.n(a);s.a},"9c71":function(e,t,r){},"9f70":function(e,t,r){},a4ac:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{staticClass:"row justify-end items-center"},[e.has_direct?r("q-badge",{staticClass:"icon-spacer q-pa-xs",attrs:{color:e.badgeColor}},[e._v("\n      AJOUT(S)\n    ")]):e._e(),e.comments?r("q-badge",{staticClass:"icon-spacer q-pa-xs",attrs:{color:e.badgeColor}},[r("q-icon",{attrs:{name:"notes",color:"white"}})],1):e._e(),e.has_dlc?r("q-badge",{staticClass:"icon-spacer q-pa-xs",attrs:{color:e.badgeColor}},[e._v("\n      DLC\n    ")]):e._e(),e.closed?r("q-badge",{staticClass:"icon-spacer q-pa-xs",attrs:{color:e.badgeColor}},[r("q-icon",{attrs:{name:"lock",color:"white"}})],1):e._e(),r("q-badge",{staticClass:"icon-spacer text-uppercase q-pa-xs",attrs:{color:e.badgeColor}},[e._v("\n      "+e._s(e.textStatus)+"\n    ")])],1)])},s=[],i=(r("a9e3"),{name:"OrderTags",props:{closed:{type:Boolean,required:!0},cart_complete:{type:Number,required:!0},has_dlc:{type:Boolean,required:!0},picking_state:{type:Number,required:!0},comments:{type:Boolean,required:!0},has_direct:{type:Boolean,required:!0}},components:{},data:function(){return{badgeColor:"primary",textStatus:"en attente"}},methods:{},mounted:function(){0===this.cart_complete?(this.badgeColor="orange-9",this.textStatus="commande incomplète"):1===this.cart_complete?(this.badgeColor="green-9",this.textStatus="commande complète"):2===this.cart_complete&&(this.badgeColor="primary",this.textStatus="en attente")}}),n=i,o=(r("a7d6"),r("2877")),c=r("58a81"),l=r("0016"),d=r("eebe"),u=r.n(d),p=Object(o["a"])(n,a,s,!1,null,null,null);t["default"]=p.exports;u()(p,"components",{QBadge:c["a"],QIcon:l["a"]})},a709:function(e,t){},a7d6:function(e,t,r){"use strict";var a=r("22f3"),s=r.n(a);s.a},a82c:function(e,t,r){"use strict";var a=r("4580"),s=r.n(a);s.a},aa0a:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("q-btn",{staticClass:"text-white q-px-md",attrs:{dense:"",flat:"",color:"primary",label:"menu"}},[r("q-menu",{attrs:{anchor:"bottom right",self:"top right"}},[r("q-list",{staticStyle:{"min-width":"100px"}},[r("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}]},[r("q-item-section",{staticStyle:{"font-size":"1.2em","text-align":"right"}},[r("div",[e._v(e._s(e.username))]),r("div",{staticClass:"text-weight-thin"},[e._v(e._s(e.id))])])],1),r("q-separator"),r("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:function(t){e.slackDirect=!0}}},[r("q-item-section",{staticStyle:{"text-align":"right","font-size":"1.2em"}},[e._v("\n            Message slack\n          ")]),r("q-item-section",{attrs:{side:""}},[r("q-icon",{attrs:{name:"email"}})],1)],1),r("q-separator"),r("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:function(t){e.rangeDate=!0}}},[r("q-item-section",{staticStyle:{"text-align":"right","font-size":"1.2em"}},[e._v("\n            Periode\n          ")]),r("q-item-section",{attrs:{side:""}},[r("q-icon",{attrs:{name:"date_range"}})],1)],1),r("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:function(t){e.singleDate=!0}}},[r("q-item-section",{staticStyle:{"text-align":"right","font-size":"1.2em"}},[e._v("Jour")]),r("q-item-section",{attrs:{side:""}},[r("q-icon",{attrs:{name:"event"}})],1)],1),r("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:e.today}},[r("q-item-section",{staticStyle:{"text-align":"right","font-size":"1.2em"}},[e._v("Aujourd'hui")]),r("q-item-section",{attrs:{side:""}},[r("q-icon",{attrs:{name:"calendar_today"}})],1)],1)],1)],1)],1),r("q-dialog",{attrs:{"full-width":""},model:{value:e.slackDirect,callback:function(t){e.slackDirect=t},expression:"slackDirect"}},[r("q-card",{staticClass:"q-pa-xs"},[r("q-card-section",{staticClass:"row items-center"},[r("div",{staticClass:"dialog-box-title"},[e._v("\n          Envoyer un message sur slack\n        ")])]),r("q-card-section",{staticClass:"row flex-center"},[r("q-input",{staticClass:"full-width",attrs:{filled:"",type:"textarea"},model:{value:e.slackMsg,callback:function(t){e.slackMsg=t},expression:"slackMsg"}})],1),r("q-card-actions",{attrs:{align:"right"}},[r("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Annuler",color:"primary"}}),r("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Envoyer",color:"primary"},on:{click:e.sendToSlack}})],1)],1)],1),r("q-dialog",{attrs:{"full-width":""},model:{value:e.singleDate,callback:function(t){e.singleDate=t},expression:"singleDate"}},[r("q-card",{staticClass:"q-pa-xs"},[r("q-card-section",{staticClass:"row items-center"},[r("div",{staticClass:"dialog-box-title"},[e._v("\n          Choisir un jour\n        ")])]),r("q-card-section",{staticClass:"row flex-center"},[r("q-date",{attrs:{locale:e.myLocale,landscape:e.isLandscape},model:{value:e.dateSelection,callback:function(t){e.dateSelection=t},expression:"dateSelection"}})],1),r("q-card-actions",{attrs:{align:"right"}},[r("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Annuler",color:"primary"}}),r("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Valider",color:"primary"},on:{click:e.onDateSelect}})],1)],1)],1),r("q-dialog",{attrs:{"full-width":""},model:{value:e.rangeDate,callback:function(t){e.rangeDate=t},expression:"rangeDate"}},[r("q-card",{staticClass:"q-pa-xs"},[r("q-card-section",{staticClass:"row items-center"},[r("div",{staticClass:"dialog-box-title"},[e._v("\n          Choisir un jour\n        ")])]),r("q-card-section",{staticClass:"row flex-center"},[r("q-date",{attrs:{locale:e.myLocale,range:"",landscape:e.isLandscape},model:{value:e.dateSelection,callback:function(t){e.dateSelection=t},expression:"dateSelection"}})],1),r("q-card-actions",{attrs:{align:"right"}},[r("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Annuler",color:"primary"}}),r("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Valider",color:"primary"},on:{click:e.onRangeSelect}})],1)],1)],1)],1)},s=[],i=(r("ac1f"),r("1276"),r("96cf"),r("c973")),n=r.n(i),o=r("c1df"),c=r.n(o),l={name:"MainMenu",data:function(){return{username:null,id:null,slackDirect:!1,slackMsg:"",singleDate:!1,dateSelection:"",myLocale:{days:"Dimanche_Lundi_Mardi_Mercredi_Jeudi_Vendredi_Samedi".split("_"),daysShort:"Dim_Lun_Mar_Mer_Jeu_Ven_Sam".split("_"),months:"Janvier_Février_Mars_Avril_Mai_Juin_Juillet_Août_Septembre_Octobre_Novembre_Décembre".split("_"),monthsShort:"Jan_Fév_Mar_Avr_Mai_Jui_Jui_Aoû_Sep_Oct_Nov_Déc".split("_"),firstDayOfWeek:1},rangeDate:!1}},methods:{today:function(){this.$emit("today")},sendToSlack:function(){var e=this;return n()(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r={},r.date=c()(),r.user=e.$store.getters.creds.user.firstname,r.msg=e.slackMsg,r.apiUrl=e.$store.getters.apiurl,r.apiKey=e.$store.getters.activeApp.config.restApiKey,r.type="direct",t.prev=7,t.next=10,e.$store.dispatch("sendMessageToSlack",r);case 10:e.$q.notify({message:"Message envoyé !",timeout:5e3,color:"green"}),t.next=16;break;case 13:t.prev=13,t.t0=t["catch"](7),e.$q.notify({message:"Un problème est survenu, veuillez re-essayer plus tard.",timeout:5e3,color:"red"});case 16:case"end":return t.stop()}}),t,null,[[7,13]])})))()},onDateSelect:function(){var e={fr:c()(this.dateSelection,"YYYY/MM/DD").startOf("day"),to:c()(this.dateSelection,"YYYY/MM/DD").endOf("day")};this.$emit("newDates",{data:e})},onRangeSelect:function(){var e={fr:c()(this.dateSelection.from,"YYYY/MM/DD").startOf("day"),to:c()(this.dateSelection.to,"YYYY/MM/DD").endOf("day")};this.$emit("newDates",{data:e})}},mounted:function(){this.username=this.$store.getters.creds.user.firstname+" "+this.$store.getters.creds.user.lastname,this.id=this.$store.getters.creds.user.id},computed:{isLandscape:function(){return!(this.$store.state.pickingModule.screenSize.windowWidth>1e3)&&this.$store.state.pickingModule.screenSize.windowWidth>this.$store.state.pickingModule.screenSize.windowHeight}}},d=l,u=(r("0b9b"),r("2877")),p=r("9c40"),m=r("4e73"),h=r("1c1c"),f=r("66e5"),v=r("4074"),g=r("eb85"),b=r("0016"),_=r("24e8"),y=r("f09f"),q=r("a370"),x=r("27f9"),w=r("4b7e"),O=r("52ee"),C=r("7f67"),k=r("eebe"),S=r.n(k),$=Object(u["a"])(d,a,s,!1,null,null,null);t["default"]=$.exports;S()($,"components",{QBtn:p["a"],QMenu:m["a"],QList:h["a"],QItem:f["a"],QItemSection:v["a"],QSeparator:g["a"],QIcon:b["a"],QDialog:_["a"],QCard:y["a"],QCardSection:q["a"],QInput:x["a"],QCardActions:w["a"],QDate:O["a"]}),S()($,"directives",{ClosePopup:C["a"]})},b203:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("q-page-container",[r("q-page",[r("div",{staticClass:"q-pa-none"},[r("q-list",{staticClass:"supplier-list"},[e._l(e.allPurchaseOrders,(function(t){return r("SupplierCard",e._b({key:t.id},"SupplierCard",t,!1))})),0===e.allPurchaseOrders.length?[r("q-card",{staticClass:"bg-white fixed-center card-aucun"},[r("q-card-section",{staticClass:"row"},[r("div",{staticClass:"text-italic text-caption aucun"},[e._v("\n                Aucun bon de commande trouvé !\n              ")])])],1)]:e._e()],2)],1),r("q-page-sticky",{attrs:{expand:"",position:"top"}},[r("TargetDate",{ref:"TargetDateInstance",on:{dateChanged:e.onDateChanged}})],1)],1)],1)},s=[],i=(r("4160"),r("a630"),r("3ca3"),r("2b0e")),n=r("bc3a"),o=r.n(n),c=r("c1df"),l=r.n(c),d=r("1bd0"),u=r("693a");i["a"].component("TargetDate",d["default"]),i["a"].component("SupplierCard",u["default"]);var p={name:"PurchaseOrdersList",components:{TargetDate:d["default"],SupplierCard:u["default"]},data:function(){return{original_allPurchaseOrders:[],allPurchaseOrders:[],queryList:{size:5e3,sort:[{expected_date:{order:"desc",unmapped_type:"boolean"}}],_source:{includes:["number","status","type","expected_date","supplier","line_items","comment","units_ordered","units_received","updated_at","validated","closed","cart_complete","has_dlc","picking_state","comments"]},query:{bool:{must:[{range:{expected_date:{gte:"",lte:""}}}]}}},indice:"purchase_order*",marker:!1}},methods:{getPoList:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;null===t?(this.queryList.query.bool.must[0].range.expected_date.gte=this.$store.getters.targetDate.dateFrom,this.queryList.query.bool.must[0].range.expected_date.lte=this.$store.getters.targetDate.dateTo):(this.queryList.query.bool.must[0].range.expected_date.gte=t.dateFrom,this.queryList.query.bool.must[0].range.expected_date.lte=t.dateTo);var r=this.$store.getters.apiurl+"generic_search/"+this.indice+"?token="+this.$store.getters.creds.token;this.$q.loading.show(),o.a.post(r,this.queryList).then((function(t){e.allPurchaseOrders=[];for(var r=0;r<t.data.records.length;r++)e.allPurchaseOrders.push(t.data.records[r]._source),e.allPurchaseOrders[r].id=t.data.records[r]._id,e.allPurchaseOrders[r].index=t.data.records[r]._index;e.original_allPurchaseOrders=e.allPurchaseOrders,e.checkPurchaseOrderModel(),e.orderTheOrders(),e.$store.commit("mutate_allPurchaseOrders",{data:e.allPurchaseOrders});var a=e.allPurchaseOrders;e.allPurchaseOrders=null,e.allPurchaseOrders=a,e.$q.loading.hide()})).catch((function(t){e.$q.loading.hide()}))},onDateChanged:function(e){this.getPoList(e)},checkPurchaseOrderModel:function(){for(var e=0;e<this.allPurchaseOrders.length;e++)this.allPurchaseOrders[e].hasOwnProperty("closed")||(this.allPurchaseOrders[e].closed=!1),this.allPurchaseOrders[e].hasOwnProperty("cart_complete")||(this.allPurchaseOrders[e].cart_complete=2),this.allPurchaseOrders[e].hasOwnProperty("has_dlc")||(this.allPurchaseOrders[e].has_dlc=!1),this.allPurchaseOrders[e].hasOwnProperty("picking_state")||(this.allPurchaseOrders[e].picking_state=0),this.allPurchaseOrders[e].hasOwnProperty("comments")||(this.allPurchaseOrders[e].comments=JSON.stringify(new Array)),this.allPurchaseOrders[e].hasOwnProperty("has_direct_product")||(this.allPurchaseOrders[e].has_direct_product=!1),this.checkItemsModel(e)},checkItemsModel:function(e){for(var t=Array.from(JSON.parse(this.allPurchaseOrders[e].line_items)),r=0;r<t.length;r++)t[r].hasOwnProperty("received")||(t[r].received=""),t[r].hasOwnProperty("dlc")&&(t[r].hasOwnProperty("dlc_date")||(t[r].dlc_date="")),t[r].hasOwnProperty("direct_product")&&(this.allPurchaseOrders[e].has_direct_product=!0);this.allPurchaseOrders[e].line_items=JSON.stringify(t)},orderTheOrders:function(){for(var e=this,t=[],r=0;r<this.allPurchaseOrders.length;r++)2===this.allPurchaseOrders[r].cart_complete&&t.push(this.allPurchaseOrders[r]);t.sort((function(e,t){var r=e.supplier.toLowerCase(),a=t.supplier.toLowerCase();return r<a?-1:r>a?1:0})),t.sort((function(e,t){var r=l()(e.expected_date).format("YYYY/MM/DD"),a=l()(t.expected_date).format("YYYY/MM/DD");return r<a?-1:r>a?1:0}));for(var a=[],s=0;s<this.allPurchaseOrders.length;s++)0===this.allPurchaseOrders[s].cart_complete&&a.push(this.allPurchaseOrders[s]);a.sort((function(e,t){var r=e.supplier.toLowerCase(),a=t.supplier.toLowerCase();return r<a?-1:r>a?1:0})),a.sort((function(e,t){var r=l()(e.expected_date).format("YYYY/MM/DD"),a=l()(t.expected_date).format("YYYY/MM/DD");return r<a?-1:r>a?1:0}));for(var i=[],n=0;n<this.allPurchaseOrders.length;n++)1===this.allPurchaseOrders[n].cart_complete&&i.push(this.allPurchaseOrders[n]);i.sort((function(e,t){var r=e.supplier.toLowerCase(),a=t.supplier.toLowerCase();return r<a?-1:r>a?1:0})),i.sort((function(e,t){var r=l()(e.expected_date).format("YYYY/MM/DD"),a=l()(t.expected_date).format("YYYY/MM/DD");return r<a?-1:r>a?1:0})),this.allPurchaseOrders=[],t.forEach((function(t){e.allPurchaseOrders.push(t)})),a.forEach((function(t){e.allPurchaseOrders.push(t)})),i.forEach((function(t){e.allPurchaseOrders.push(t)}))}},mounted:function(){this.getPoList();var e=3e4;this.interval=setInterval(function(){this.getPoList()}.bind(this),e)},beforeDestroy:function(){clearInterval(this.interval)}},m=p,h=(r("ea63"),r("2877")),f=r("09e3"),v=r("9989"),g=r("1c1c"),b=r("f09f"),_=r("a370"),y=r("de5e"),q=r("eebe"),x=r.n(q),w=Object(h["a"])(m,a,s,!1,null,null,null);t["default"]=w.exports;x()(w,"components",{QPageContainer:f["a"],QPage:v["a"],QList:g["a"],QCard:b["a"],QCardSection:_["a"],QPageSticky:y["a"]})},b8d7:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("q-page",{staticClass:"flex bg-grey-5 row"},[r("q-resize-observer",{attrs:{debounce:"500"},on:{resize:e.onResize}}),e.isPurchaseOrderDisplayed?r("div",{staticClass:"bg-grey-2  full-width"},[r("PurchaseOrderDisplay")],1):r("div",{staticClass:"bg-grey-2 full-width"},[r("PurchaseOrdersList")],1)],1)},s=[],i=(r("96cf"),r("c973")),n=r.n(i),o=r("2b0e"),c=r("bc3a"),l=r.n(c),d=r("c1df"),u=r.n(d),p=r("b203"),m=r("22f4");o["a"].component("PurchaseOrdersList",p["default"]),o["a"].component("PurchaseOrderDisplay",m["default"]);var h={name:"MvpPicking",components:{PurchaseOrdersList:p["default"],PurchaseOrderDisplay:m["default"]},data:function(){return{leftDrawerOpen:!1,isPurchaseOrderDisplayed:!1,marker:!1}},methods:{createCustomStore:function(){this.$store.registerModule("pickingModule",{state:{targetDate:{dateFrom:"",dateTo:"",dateFromShort:"",dateToShort:""},currentOrder:{meta:{id:"",index:""},details:{},cart:{}},allPurchaseOrders:{},screenSize:{windowHeight:"",windowWidth:"",appWidth:"",appHeight:""},slack_api_key:""},getters:{targetDate:function(e){return e.targetDate},currentOrder:function(e){return e.currentOrder},getOrderDetails:function(e){return e.currentOrder.details},allPurchaseOrders:function(e){return e.allPurchaseOrders},screenSize:function(e){return e.screenSize},slackKey:function(e){return e.slack_api_key}},mutations:{mutate_screenSize:function(e,t){e.screenSize=t.data},mutate_targetDate:function(e,t){e.targetDate=t.dateObj},mutate_currentOrder:function(e,t){e.currentOrder=t.order},mutate_allPurchaseOrders:function(e,t){e.allPurchaseOrders=t.data}},actions:{sendMessageToSlack:function(e,t){return n()(regeneratorRuntime.mark((function r(){var a,s,i,n,o,c,d,p,m,h,f,v;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:for(e.commit,a="",s="",i="",n="",o=JSON.parse(['[{"user":"Valentin"','"id":"<@U01DKKRJU20>"}','{"user":"Jérémie"','"id":"<@U5DG4AV09>"}','{"user":"MC"','"id":"<@UMR8N95QR>"}','{"user":"Juliette"','"id":"<@U019L298P7Y>"}]']),c=0;c<o.length;c++)c===o.length-1?s+=o[c].id:s+=o[c].id+" ";if(d=null,"PO-NYX"!==t.poType&&(d=t.poType),"direct"===t.type?(n="#appro",i="Message de "+t.user,a="[ "+t.user+" | "+u()(t.date).format("DD/MM/YYYY")+" ]\n"+t.msg):"po"===t.type?(n="#appro",i="Tournée de ramassage : "+t.supplier,a="[ "+t.user+" | "+t.supplier+" | ",null!==d&&(a+=d+" | "),a+=u()(t.date).format("DD/MM/YYYY")+" ]\n"+t.msg):"problem"===t.type&&(n="#ramassage",i="Tournée de ramassage : problème reporté",a="[ "+t.user+" | "+t.supplier+" | ",null!==d&&(a+=d+" | "),a+=u()(t.date).format("DD/MM/YYYY")+" ]"),p=[{type:"header",text:{type:"plain_text",text:i}},{type:"section",text:{type:"mrkdwn",text:s}},{type:"section",text:{type:"plain_text",text:a}}],"problem"===t.type){if(t.problems.less.length>0)for(p.push({type:"divider"}),m={type:"section",text:{type:"mrkdwn",text:"*Il manque des produits :*"}},p.push(m),c=0;c<t.problems.less.length;c++)h={type:"section",text:{type:"mrkdwn",text:"*Produit :* "+t.problems.less[c].title+"\n*SKU :* "+t.problems.less[c].sku+"\n*Quantité reçue :* "+t.problems.less[c].received+" / "+t.problems.less[c].quantity}},p.push(h);if(t.problems.more.length>0)for(p.push({type:"divider"}),m={type:"section",text:{type:"mrkdwn",text:"*Il a des produits en surplus :*"}},p.push(m),c=0;c<t.problems.more.length;c++)h={type:"section",text:{type:"mrkdwn",text:"*Produit :* "+t.problems.more[c].title+"\n*SKU :* "+t.problems.more[c].sku+"\n*Quantité reçue :* "+t.problems.more[c].received+" / "+t.problems.more[c].quantity}},p.push(h);if(t.problems.new.length>0)for(p.push({type:"divider"}),m={type:"section",text:{type:"mrkdwn",text:"*Il y a des produits non commandé :*"}},p.push(m),c=0;c<t.problems.new.length;c++)h={type:"section",text:{type:"mrkdwn",text:"*Produit :* "+t.problems.new[c].title+"\n*Quantité reçue :* "+t.problems.new[c].received+" / "+t.problems.new[c].quantity}},p.push(h);p.push({type:"divider"})}return f={channel:n,blocks:p},v=t.apiUrl+"lambdas/4/publish_to_slack?apikey="+t.apiKey,r.abrupt("return",l.a.post(v,f));case 15:case"end":return r.stop()}}),r)})))()}}})},addEventListener:function(){var e=this;this.$root.$on("displayOrderEvent",(function(t){e.displayOrderEvent(t)})),this.$root.$on("displayListEvent",(function(t){e.displayListEvent(t)}))},removeEventListener:function(){this.$root.$off("displayOrderEvent"),this.$root.$off("displayListEvent")},displayOrderEvent:function(e){this.$store.commit("mutate_currentOrder",{order:{meta:{id:e.id,index:e.index}}}),this.isPurchaseOrderDisplayed=!0},displayListEvent:function(e){this.$store.commit("mutate_currentOrder",{order:{meta:{id:"",index:""}}}),this.isPurchaseOrderDisplayed=!1},onResize:function(e){var t={windowWidth:window.innerWidth,windowHeight:window.innerHeight,appHeight:e.height,appWidth:e.width};this.$store.commit("mutate_screenSize",{data:t})}},beforeCreate:function(){this.$q.platform.is.mobile&&this.$q.fullscreen.request().then((function(){})).catch((function(e){}))},created:function(){this.createCustomStore(),this.addEventListener()},beforeMount:function(){},mounted:function(){},beforeDestroy:function(){this.removeEventListener(),this.$store.unregisterModule("pickingModule")},destroyed:function(){this.$q.platform.is.mobile&&this.$q.fullscreen.exit().then((function(){})).catch((function(e){}))},computed:{}},f=h,v=r("2877"),g=r("9989"),b=r("3980"),_=r("eebe"),y=r.n(_),q=Object(v["a"])(f,a,s,!1,null,null,null);t["default"]=q.exports;y()(q,"components",{QPage:g["a"],QResizeObserver:b["a"]})},c9fc:function(e,t,r){},da41:function(e,t,r){"use strict";var a=r("e196"),s=r.n(a);s.a},dad6:function(e,t,r){},e196:function(e,t,r){},ea63:function(e,t,r){"use strict";var a=r("9f70"),s=r.n(a);s.a},fbe3:function(e,t,r){}});